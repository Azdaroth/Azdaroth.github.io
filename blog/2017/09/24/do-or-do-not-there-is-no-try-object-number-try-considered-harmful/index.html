
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Do. Or do not. There is no try - Object#try considered harmful - Karol Galanciak - Ruby on Rails and Ember.js consultant</title>
  <meta name="author" content="Karol Galanciak">

  
  <meta name="description" content="Karol Galanciak - Ruby on Rails and Ember.js consultant, building ambitious and high performant web applications.">

  
  <meta name="keywords" content="Ruby on Rails, Ember.js, PostgreSQL, JavaScript, Consulting, MVP, post MVP, legacy apps">

  
  

  <meta property="og:title" value="Do. Or do not. There is no try - Object#try considered harmful - Karol Galanciak - Ruby on Rails and Ember.js consultant" />
  <meta property="og:description" value="Karol Galanciak - Ruby on Rails and Ember.js consultant, building ambitious and high performant web applications." />
  <meta property="og:url" value="https://karolgalanciak.com/blog/2017/09/24/do-or-do-not-there-is-no-try-object-number-try-considered-harmful/" />
  <meta property="og:type" content="website" />
  
  <meta property="og:site_name" content="Karol Galanciak - Ruby on Rails and Ember.js consultant"/>
  <meta property="og:locale" content="en_US" />

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@Azdaroth">
  <meta name="twitter:creator" content="@Azdaroth">
  <meta name="twitter:title" content="Do. Or do not. There is no try - Object#try considered harmful - Karol Galanciak - Ruby on Rails and Ember.js consultant">
  <meta name="twitter:url" content="">
  <meta name="twitter:description" content="Karol Galanciak - Ruby on Rails and Ember.js consultant, building ambitious and high performant web applications.">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://karolgalanciak.com/blog/2017/09/24/do-or-do-not-there-is-no-try-object-number-try-considered-harmful">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Karol Galanciak - Ruby on Rails and Ember.js consultant" type="application/atom+xml">
  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "BlogPosting",
      "mainEntityOfPage": {
        "@type":"WebPage",
        "@id": "https://karolgalanciak.com/blog/2017/09/24/do-or-do-not-there-is-no-try-object-number-try-considered-harmful"
      },
      "headline": "Do. Or do not. There is no try - Object#try considered harmful - Karol Galanciak - Ruby on Rails and Ember.js consultant",
        "image": {
        "@type": "ImageObject",
        "url": "",
        "height": 640,
        "width": 1024
      },
      "datePublished": "2017-09-24",
      "dateModified": "2019-02-24",
      "author": {
        "@type": "Person",
        "name": "Karol Galanciak"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Karol Galanciak",
        "logo": {
          "@type": "ImageObject",
          "url": "https://karolgalanciak.com/images/me_formal.jpg",
          "width": 600,
          "height": 60
        }
      },
      "description": "Karol Galanciak - Ruby on Rails and Ember.js consultant, building ambitious and high performant web applications.",
      "keywords": "Ruby on Rails, Ember.js, PostgreSQL, JavaScript, Consulting, MVP, post MVP, legacy apps"
    }
  </script>
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-42570582-1', 'auto');
    ga('send', 'pageview');
    ga('set', 'anonymizeIp', true);
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Karol Galanciak - Ruby on Rails and Ember.js consultant</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:karolgalanciak.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">About Me</a></li>
  <li><a href="/blog">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/test-driven-ember">Test-Driven Ember Book</a></li>
  <li><a href="/presentations">Presentations</a></li>
  <li><a href="/publications">Publications</a></li>
  <li><a href="/open-source">Open Source</a></li>
  <li><a href="/privacy-policy">Privacy Policy</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Do. Or Do Not. There Is No Try - Object#try Considered Harmful</h1>
    
    
      <p class="meta">
        








  


<time datetime="2017-09-24T22:00:00+02:00" pubdate data-updated="true">Sep 24<span>th</span>, 2017</time>
        
      </p>
    
  </header>


<div class="entry-content"><p><a href="https://apidock.com/rails/v4.2.7/Object/try" target="_blank"><code>Object#try</code></a> is quite a commonly used method in <strong>Rails applications</strong> to cover cases where there is a possibility of dealing with a <code>nil</code> value or to provide <strong>flexible interface</strong> for handling cases where some kind of object doesn&rsquo;t necessarily implement given method. Thanks to <code>try</code>, we may avoid getting <code>NoMethodError</code>. So it seems like it&rsquo;s perfect, right? No <code>NoMethodError</code> exception, no problem?</p>

<p>Well, not really. There are some <strong>severe problems</strong> with using <code>Object#try</code>, and usually, it&rsquo;s quite easy to implement a solution that would be much better.</p>

<!--more-->


<h2>Object#try &ndash; how does it work?</h2>

<p>The idea behind <code>Object#try</code> is simple: instead of raising <code>NoMethodError</code> exception when calling some method on <code>nil</code> or calling a method on non-<code>nil</code> object that is not implemented by this object, it just returns <code>nil</code>.</p>

<p>Imagine that you want to grab the email of the first user. To make sure it won&rsquo;t blow up when there are no users, you could write it the following way:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>user.first.try(:email)</span></code></pre></td></tr></table></div></figure>


<p>What if you implemented some generic service where you can pass many types of objects and, e.g., after saving the object it attempts to send a notification if the object happens to implement a proper method for that? With <code>Object#try</code> it could be done like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="k">class</span> <span class="nc">MyService</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">object</span><span class="p">)</span>
</span><span class='line'>    <span class="n">object</span><span class="o">.</span><span class="n">save!</span>
</span><span class='line'>    <span class="n">object</span><span class="o">.</span><span class="n">try</span><span class="p">(</span><span class="ss">:send_success_notification</span><span class="p">,</span> <span class="s2">&quot;saved from MyService&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>As you can see, it is also possible to provide <code>arguments</code> of the method.</p>

<p>What if you need to do some chaining of the methods where you can get <code>nil</code> at each intermediate step? No problem, you can use <code>Object#try</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">payment</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">try</span><span class="p">(</span><span class="ss">:addresses</span><span class="p">)</span><span class="o">.</span><span class="n">try</span><span class="p">(</span><span class="ss">:first</span><span class="p">)</span><span class="o">.</span><span class="n">try</span><span class="p">(</span><span class="ss">:country</span><span class="p">)</span><span class="o">.</span><span class="n">try</span><span class="p">(</span><span class="ss">:name</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>What is the problem then?</h2>

<p>Apparently, <code>Object#try</code> is capable of handling multiple cases, so what is the problem with using it?</p>

<p>Well, there are many. The biggest issue with <code>Object#try</code> is that in many cases it <code>solves</code> problems that should never happen in the first place and that problem is <code>nil</code>. The another one is that the intention of using it is not clear. What does the following code try to say?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">payment</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">try</span><span class="p">(</span><span class="ss">:address</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Is it a legit case that some payment might not have a client and indeed it could be <code>nil</code>? Or is added &ldquo;just in case&rdquo; if <code>client</code> happens to be <code>nil</code> to not blow up with <code>NoMethodError</code> exception? Or even worse, does <code>client</code> happen to be a polymorphic relationship where some models implement <code>addresses</code> method and the others don&rsquo;t? Or maybe there is a problem with data integrity, and for a few payments the client was deleted for some reason, and it&rsquo;s no longer there?</p>

<p>Just by looking at this code it is impossible to tell what&rsquo;s the intention of <code>Object#try</code>, there are just too many possibilities.</p>

<p>Fortunately, there are plenty of alternative solutions that you can apply to get rid of <code>Object#try</code> and make your code clear and expressive &ndash; thanks to that, it will be much more maintainable, more readable and less prone to bugs as the intention will no longer be ambiguous.</p>

<h2>Alternative solutions</h2>

<p>Here are few &ldquo;patterns&rdquo; you could apply depending on the context where <code>Object#try</code> is used.</p>

<h3>Respecting Law of Demeter</h3>

<p><a href="https://en.wikipedia.org/wiki/Law_of_Demeter" target="_blank">Law of Demeter</a> is a handy rule (I wouldn&rsquo;t go that far to call it a &ldquo;law&rdquo; though) which helps avoid structural coupling. What it states is that hypothetical object A should be only interested in its own immediate surrounding and should not be aware of the internal structure of its collaborators or associations. In many cases, it means having only one &ldquo;dot&rdquo; in method calls. However, <strong>Law of Demeter</strong> is not really about the amount of &ldquo;dots&rdquo; (method calls), it&rsquo;s only about the coupling between objects, so chained operations and transformations are perfectly fine, e.g., the following example doesn&rsquo;t violate the law:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">input</span><span class="o">.</span><span class="n">to_s</span><span class="o">.</span><span class="n">strip</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:capitalize</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>but the following one does:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">payment</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">address</span>
</span></code></pre></td></tr></table></div></figure>


<p>Respecting <strong>Law of Demeter</strong> usually results in a clean and maintainable code, so unless you have a good reason to violate it, you should stick to the law and avoid tight coupling.</p>

<p>Let&rsquo;s get back to the example with <code>payment</code>, <code>client</code> and <code>address</code>. How could we refactor the following code?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">payment</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">try</span><span class="p">(</span><span class="ss">:address</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>The first thing would be to reduce structural coupling and implement <code>Payment#client_address</code> method:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="k">class</span> <span class="nc">Payment</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">client_address</span>
</span><span class='line'>    <span class="n">client</span><span class="o">.</span><span class="n">try</span><span class="p">(</span><span class="ss">:address</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>It&rsquo;s much better now &ndash; instead of referring to the address via <code>payment.client.try(:address)</code> we can simply do <code>payment.client_address</code>, which is already an improvement as <code>Object#try</code> happens only in one place. Let&rsquo;s refactor it further.</p>

<p>We are left now with two options: either <code>client</code> being <code>nil</code> is a legit case or not. If it is, we can make the code look confident and explicitly return early, which clearly shows that having no <code>client</code> is a valid use case:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="k">class</span> <span class="nc">Payment</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">client_address</span>
</span><span class='line'>    <span class="k">return</span> <span class="kp">nil</span> <span class="k">if</span> <span class="n">client</span><span class="o">.</span><span class="n">nil?</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">client</span><span class="o">.</span><span class="n">address</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>If it never happens to be <code>nil</code>, we can skip the guard statement:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="k">class</span> <span class="nc">Payment</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">client_address</span>
</span><span class='line'>    <span class="n">client</span><span class="o">.</span><span class="n">address</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Such delegations are pretty generic; maybe Rails has some nice solution to this problem? The answer is &ldquo;yes&rdquo;! <code>ActiveSupport</code> offers a very nice solution to the exact issue: <a href="http://api.rubyonrails.org/classes/Module.html#method-i-delegate" target="_blank"><code>ActiveSupport#delegate</code></a> macro. Thanks to that macro, you can define delegations and even handle <code>nil</code> in the exact way we did it.</p>

<p>The first example, where <code>nil</code> is a legit use case, could be rewritten the following way:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="k">class</span> <span class="nc">Payment</span>
</span><span class='line'>  <span class="n">delegate</span> <span class="ss">:address</span><span class="p">,</span> <span class="ss">to</span><span class="p">:</span> <span class="ss">:client</span><span class="p">,</span> <span class="ss">prefix</span><span class="p">:</span> <span class="kp">true</span><span class="p">,</span> <span class="n">allow_nil</span><span class="p">:</span> <span class="kp">true</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>and the second one, if <code>nil</code> is never to be expected:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="k">class</span> <span class="nc">Payment</span>
</span><span class='line'>  <span class="n">delegate</span> <span class="ss">:address</span><span class="p">,</span> <span class="ss">to</span><span class="p">:</span> <span class="ss">:client</span><span class="p">,</span> <span class="ss">prefix</span><span class="p">:</span> <span class="kp">true</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Much cleaner, less coupled and we&rsquo;ve managed to achieve the final result of not using <code>Object#try</code>, but just in a much more elegant way.</p>

<p>However, it is still possible that we might not expect payment to have an empty client (e.g. payment for the transaction that is not completed yet) in some cases, e.g., when displaying data for the payments with completed transactions, but somehow we are getting dreaded <code>NoMethodEror</code> exception. It doesn&rsquo;t necessarily mean that we need to add <code>allow_nil: true</code> option in <code>delegate</code> macro and for sure it doesn&rsquo;t mean that we should use <code>Object#try</code>. The solution here would be:</p>

<h3>Operating on the scoped data</h3>

<p>If we want to deal payments with completed transactions, which are guaranteed to have <code>client</code>, why not simply make sure that we are dealing with the right set of data? In Rails apps that would probably mean applying some ActiveRecord <code>scope</code> to <code>Payment</code>s collection, like <code>with_completed_transactions</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="no">Payment</span><span class="o">.</span><span class="n">with_completed_transactions</span><span class="o">.</span><span class="n">find_each</span> <span class="k">do</span> <span class="o">|</span><span class="n">payment</span><span class="o">|</span>
</span><span class='line'>  <span class="n">do_something_with_address</span><span class="p">(</span><span class="n">payment</span><span class="o">.</span><span class="n">client_address</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Since we never plan to do anything with client&rsquo;s <code>address</code> for payments for not completed transactions, we don&rsquo;t need to explicitly handle <code>nil</code>s here.</p>

<p>Nevertheless, even if <code>client</code> were always required for creating a payment, it would still be possible that such code might result in <code>NoMethodError</code>. One example where that might happen would be a deleted by mistake associated <code>client</code> record. In that case, we would need to fix:</p>

<h3>Data integrity</h3>

<p>Ensuring data integrity, especially with RDBMS like PostgreSQL, is quite simple &ndash; we just need to remember about adding the right constraints when creating new tables. Keep in mind that this needs to be handled on a database level, validations in models are never enough as they can easily be bypassed. To avoid the issue where <code>client</code> turns out to be <code>nil</code>, despite presence validation, we should add <code>NOT NULL</code> and <code>FOREIGN KEY</code> constraints when creating <code>payments</code> table, which will prevent us from not having a client assigned at all and also deleting the client record if it&rsquo;s still associated with some payment:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">create_table</span> <span class="ss">:payments</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
</span><span class='line'>  <span class="n">t</span><span class="o">.</span><span class="n">references</span> <span class="ss">:client</span><span class="p">,</span> <span class="ss">index</span><span class="p">:</span> <span class="kp">true</span><span class="p">,</span> <span class="n">foreign_key</span><span class="p">:</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">null</span><span class="p">:</span> <span class="kp">false</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>And that&rsquo;s it! By remembering about those constraints, you can avoid a lot of unexpected use cases with <code>nil</code>s.</p>

<h3>Ensuring types via explicit conversion</h3>

<p>I saw few times <code>Object#try</code> used in a quite exotic way which looked similar to this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">params</span><span class="o">[</span><span class="ss">:name</span><span class="o">].</span><span class="n">try</span><span class="p">(</span><span class="ss">:upcase</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Well, this code clearly shows that some string is expected to be found under <code>name</code> key in <code>params</code>, so why not just ensure it is a string by applying explicit conversion using <code>to_s</code> method?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">params</span><span class="o">[</span><span class="ss">:name</span><span class="o">].</span><span class="n">to_s</span><span class="o">.</span><span class="n">upcase</span>
</span></code></pre></td></tr></table></div></figure>


<p>Much cleaner that way!</p>

<p>However, those two codes are not equivalent. The former one returns a string if <code>params[:name]</code> is a string, but if it is <code>nil</code>, it will return <code>nil</code>. The latter always returns a string. It is not entirely clear if <code>nil</code> is expected in such case (which is the obvious problem with <code>Object#try</code>), so we are left with two options:</p>

<ul>
<li><code>nil</code> is the expected return value if <code>params[:name]</code> is <code>nil</code> &ndash; might not be the best idea as dealing with nils instead of strings might be quite inconvenient, however, in some cases, it might be necessary to have <code>nil</code>s. If that&rsquo;s the case, we can make it clear that we expect <code>params[:name]</code> to be <code>nil</code> by adding a guard statement:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="k">return</span> <span class="k">if</span> <span class="n">params</span><span class="o">[</span><span class="ss">:name</span><span class="o">].</span><span class="n">nil?</span>
</span><span class='line'>
</span><span class='line'><span class="n">params</span><span class="o">[</span><span class="ss">:name</span><span class="o">].</span><span class="n">to_s</span><span class="o">.</span><span class="n">upcase</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>a string is the expected return type &ndash; we don&rsquo;t need to bother with guard statements, and we can just keep the explicit conversion:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">params</span><span class="o">[</span><span class="ss">:name</span><span class="o">].</span><span class="n">to_s</span><span class="o">.</span><span class="n">upcase</span>
</span></code></pre></td></tr></table></div></figure>


<p>In more complex scenarios, it might be a better idea to use form objects and/or have a more robust types management, e.g. by using <a href="https://github.com/dry-rb/dry-types" target="_blank">dry-types</a>, but the idea would still be the same as for explicit conversions, it would just be better as far as the design goes.</p>

<h3>Using right methods</h3>

<p>Dealing with nested hashes is quite a common use case, especially when building APIs and dealing with user-provided payload. Imagine you are dealing with JSONAPI-compliant API and want to grab client&rsquo;s name when updating. The expected payload might look like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="ss">data</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nb">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">type</span><span class="p">:</span> <span class="s2">&quot;clients&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">attributes</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="nb">name</span><span class="p">:</span> <span class="s2">&quot;some name&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>However, since we never know if the API consumer provided a proper payload or not, it would make sense to assume that the structure won&rsquo;t be right.</p>

<p>One terrible way to handle it would be using&hellip; guess what? Obviously <code>Object#try</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">params</span><span class="o">[</span><span class="ss">:data</span><span class="o">].</span><span class="n">try</span><span class="p">(</span><span class="ss">:[]</span><span class="p">,</span> <span class="ss">:attributes</span><span class="p">)</span><span class="o">.</span><span class="n">try</span><span class="p">(</span><span class="ss">:[]</span><span class="p">,</span> <span class="ss">:name</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>It&rsquo;s certainly hard to say that this code looks pleasant. And the funny thing is that it is really easy to rewrite cleanly.</p>

<p>One solution would be applying explicit conversions on each intermediate step:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">params</span><span class="o">[</span><span class="ss">:data</span><span class="o">].</span><span class="n">to_h</span><span class="o">[</span><span class="ss">:attributes</span><span class="o">].</span><span class="n">to_h</span><span class="o">[</span><span class="ss">:name</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>That&rsquo;s better, but not really expressive. Ideally, we would use some dedicated method. One of those potentially dedicated methods is <a href="https://ruby-doc.org/core-2.2.0/Hash.html#method-i-fetch" target="_blank"><code>Hash#fetch</code></a> which allows you to provide a value that should be returned if the given key is not present in the hash:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">params</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="ss">:data</span><span class="p">)</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="ss">:attributes</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="ss">:name</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>It looks even better but would be nice to have something even more dedicated for digging through nested hashes. Fortunately, since Ruby 2.3.0, we can take advantage of <a href="http://ruby-doc.org/core-2.3.0_preview1/Hash.html#method-i-dig" target="_blank"><code>Hash#dig</code></a>, which was implemented for exactly this purpose &ndash; digging through nested hashes and not raising exceptions if some intermediate key turns out to not be there:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">params</span><span class="o">.</span><span class="n">dig</span><span class="p">(</span><span class="ss">:data</span><span class="p">,</span> <span class="ss">:attributes</span><span class="p">,</span> <span class="ss">:name</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Having Proper interfaces / Duck typing</h3>

<p>Let&rsquo;s get back to the example that was mentioned in the beginning with sending a potential notification:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="k">class</span> <span class="nc">MyService</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">object</span><span class="p">)</span>
</span><span class='line'>    <span class="n">object</span><span class="o">.</span><span class="n">save!</span>
</span><span class='line'>    <span class="n">object</span><span class="o">.</span><span class="n">try</span><span class="p">(</span><span class="ss">:send_success_notification</span><span class="p">,</span> <span class="s2">&quot;saved from MyService&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>There are two possible solutions here:</p>

<ul>
<li><strong>Implementing two set of services</strong> &ndash; one that sends notifications and one that doesn&rsquo;t:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="k">class</span> <span class="nc">MyServiceA</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">object</span><span class="p">)</span>
</span><span class='line'>    <span class="n">object</span><span class="o">.</span><span class="n">save!</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">MyServiceB</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">object</span><span class="p">)</span>
</span><span class='line'>    <span class="n">object</span><span class="o">.</span><span class="n">save!</span>
</span><span class='line'>    <span class="n">object</span><span class="o">.</span><span class="n">send_success_notification</span><span class="p">(</span><span class="s2">&quot;saved from MyService&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Thanks to this refactoring, the code is much cleaner, and we easily got rid of <code>Object#try</code>. However, now we need to know that for one type of objects we need to use <code>MyServiceA</code> and for another type <code>MyServiceB</code>. It might make sense, but might also be a problem. In such case the 2nd option would be better:</p>

<ul>
<li><strong>Duck typing</strong>. Simply add <code>send_success_notification</code> method to all objects that are passed to <code>MyService</code> and if it&rsquo;s supposed to do nothing, just leave the method body empty:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="k">class</span> <span class="nc">MyService</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">object</span><span class="p">)</span>
</span><span class='line'>    <span class="n">object</span><span class="o">.</span><span class="n">save!</span>
</span><span class='line'>    <span class="n">object</span><span class="o">.</span><span class="n">send_success_notification</span><span class="p">(</span><span class="s2">&quot;saved from MyService&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>The extra benefit of this option is that it helps to identify some common behaviors of the objects and to make them explicit. As you can see, in case of <code>Object#try</code> a lot of domain concepts might stay implicit and unclear. It doesn&rsquo;t mean they are not there; they are just not clearly identified. This is yet another important thing to keep in mind &ndash; <code>Object#try</code> also hurts your domain.</p>

<h3>Null Object Pattern</h3>

<p>Let&rsquo;s reuse the example above with sending notifications after persisting some models and do a little modification &ndash; we will make <code>mailer</code> an argument of the method and call <code>send_success_notification</code> on it:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="k">class</span> <span class="nc">MyService</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">object</span><span class="p">,</span> <span class="ss">mailer</span><span class="p">:</span> <span class="no">SomeMailer</span><span class="p">)</span>
</span><span class='line'>    <span class="n">object</span><span class="o">.</span><span class="n">save!</span>
</span><span class='line'>    <span class="n">mailer</span><span class="o">.</span><span class="n">send_success_notification</span><span class="p">(</span><span class="n">object</span><span class="p">,</span> <span class="s2">&quot;saved from MyService&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>That&rsquo;s going to work great if we always want to send a notification. What if we don&rsquo;t want to do it? One terrible way to handle it would be passing <code>nil</code> as a mailer and take advantage of <code>Object#try</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="k">class</span> <span class="nc">MyService</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">object</span><span class="p">,</span> <span class="ss">mailer</span><span class="p">:</span> <span class="no">SomeMailer</span><span class="p">)</span>
</span><span class='line'>    <span class="n">object</span><span class="o">.</span><span class="n">save!</span>
</span><span class='line'>    <span class="n">mailer</span><span class="o">.</span><span class="n">try</span><span class="p">(</span><span class="ss">:send_success_notification</span><span class="p">,</span> <span class="n">object</span><span class="p">,</span> <span class="s2">&quot;saved from MyService&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="no">Service</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">object</span><span class="p">,</span> <span class="ss">mailer</span><span class="p">:</span> <span class="kp">nil</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>But you&rsquo;ve probably already guessed this solution is a no-go. Fortunately, we can apply <a href="https://en.wikipedia.org/wiki/Null_Object_pattern" target="_blank">Null Object Pattern</a> and pass an instance of some <code>NullMailer</code> which implements <code>send_success_notification</code> method that simply does nothing:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="k">class</span> <span class="nc">NullMailer</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">send_success_notification</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">MyService</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">object</span><span class="p">,</span> <span class="ss">mailer</span><span class="p">:</span> <span class="no">SomeMailer</span><span class="p">)</span>
</span><span class='line'>    <span class="n">object</span><span class="o">.</span><span class="n">save!</span>
</span><span class='line'>    <span class="n">mailer</span><span class="o">.</span><span class="n">send_success_notification</span><span class="p">(</span><span class="n">object</span><span class="p">,</span> <span class="s2">&quot;saved from MyService&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="no">MyService</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">object</span><span class="p">,</span> <span class="ss">mailer</span><span class="p">:</span> <span class="no">NullMailer</span><span class="o">.</span><span class="n">new</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>That&rsquo;s certainly better than using <code>Object#try</code>.</p>

<h2>What about <code>&amp;.</code> a.k.a. lonely/safe navigation operator?</h2>

<p><code>&amp;.</code>, lonely/safe navigation operator is a pretty new thing introduced in Ruby 2.3.0. It&rsquo;s quite similar to <code>Object#try</code>, but it&rsquo;s less ambiguous &ndash; if you call a method on the object different than <code>nil</code>, and this method is not implemented by that object, <code>NoMethodError</code> will still be raised which is not the case for <code>Object#try</code>. Check the following examples:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="no">User</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">try</span><span class="p">(</span><span class="ss">:unknown_method</span><span class="p">)</span> <span class="c1"># assuming `user` is nil</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="kp">nil</span>
</span><span class='line'>
</span><span class='line'><span class="no">User</span><span class="o">.</span><span class="n">first</span><span class="o">&amp;.</span><span class="n">unknown_method</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="kp">nil</span>
</span><span class='line'>
</span><span class='line'><span class="no">User</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">try</span><span class="p">(</span><span class="ss">:unknown_method!</span><span class="p">)</span> <span class="c1"># assuming `user` is not nil</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="kp">nil</span>
</span><span class='line'>
</span><span class='line'><span class="no">User</span><span class="o">.</span><span class="n">first</span><span class="o">&amp;.</span><span class="n">unknown_method</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="ss">NoMethodError</span><span class="p">:</span> <span class="n">undefined</span> <span class="nb">method</span> <span class="sb">`unknown_method&#39; for #&lt;User:0x007fb10c0fd498&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Does it mean safe navigation operator is fine and safe to use? Not really. It still comes with the same problems as <code>Object#try</code> does, it&rsquo;s merely one serious issue less.</p>

<p>Nevertheless, I think there is a case where the lonely operator is not that bad. Check the following example:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="no">Comment</span><span class="o">.</span><span class="n">create!</span><span class="p">(</span>
</span><span class='line'>  <span class="ss">content</span><span class="p">:</span> <span class="n">content</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">author</span><span class="p">:</span> <span class="n">current_user</span><span class="p">,</span>
</span><span class='line'>  <span class="n">group_id</span><span class="p">:</span> <span class="n">current_user</span><span class="o">&amp;.</span><span class="n">group_id</span><span class="p">,</span>
</span><span class='line'><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>What we want to do is create a comment belonging to some <code>current_user</code> who might be an author and also assign a <code>group_id</code> from <code>current_user</code>, who might be nil.</p>

<p>The same code could be written as:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="no">Comment</span><span class="o">.</span><span class="n">create!</span><span class="p">(</span><span class="ss">content</span><span class="p">:</span> <span class="n">content</span><span class="p">,</span> <span class="ss">author</span><span class="p">:</span> <span class="n">current_user</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">c</span><span class="o">|</span>
</span><span class='line'>  <span class="n">c</span><span class="o">.</span><span class="n">group_id</span> <span class="o">=</span> <span class="n">current_user</span><span class="o">&amp;.</span><span class="n">group_id</span> <span class="k">if</span> <span class="n">current_user</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>or maybe as:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">comment_params</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="ss">content</span><span class="p">:</span> <span class="n">content</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">author</span><span class="p">:</span> <span class="n">current_user</span><span class="p">,</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">comment_params</span><span class="o">[</span><span class="ss">:group_id</span><span class="o">]</span> <span class="o">=</span> <span class="n">current_user</span><span class="o">.</span><span class="n">group_id</span> <span class="k">if</span> <span class="n">current_user</span>
</span><span class='line'>
</span><span class='line'><span class="no">Comment</span><span class="o">.</span><span class="n">create!</span><span class="p">(</span><span class="n">comment_params</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>But I think neither of those alternatives is more readable than the first example with <code>&amp;.</code> operator, so might be worth trading a bit of clarity for more readability.</p>

<h2>Wrapping Up</h2>

<p>I believe there is not a single valid use case for <code>Object#try</code> due to the <strong>ambiguity</strong> of its intentions, <strong>negative impact</strong> on the <strong>domain</strong> model and simply for the fact that there are <strong>many other ways</strong> to solve the problems that <code>Object#try</code> &ldquo;solves&rdquo; in a clumsy way &ndash; starting from respecting Law of Demeter and delegations, through operating on properly scoped data, applying right database constraints, ensuring types using explicit conversions, using proper methods, having right interfaces, taking advantage of duck typing, ending with Null Object Pattern  or even using the safe navigation operator (<code>&amp;.</code>) which is much safer to use and might be applied in limited cases.</p>

<p><img src="/images/object_try/yoda.jpeg" title="yoda" alt="yoda"></p>

<p class="small-p center">
  Source: https://www.pbnsg.org/weight-management/2015/7/27/do-or-do-not-there-is-no-try-yoda
</p>



</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Karol Galanciak</span></span>

      








  


<time datetime="2017-09-24T22:00:00+02:00" pubdate data-updated="true">Sep 24<span>th</span>, 2017</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/architecture/'>Architecture</a>, <a class='category' href='/blog/categories/design-patterns/'>Design Patterns</a>, <a class='category' href='/blog/categories/rails/'>Rails</a>, <a class='category' href='/blog/categories/ruby/'>Ruby</a>
  
</span>


    </p>
    <div class="meta top-line">
      <div class="post-subscription">
  <div id="mc_embed_signup">
    <div id="mc_embed_signup_scroll">
      <label for="mce-EMAIL">Do you want to take your developer skills to the next level? Subscribe to my newsletter and never miss another blog post!</label>
      <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
      <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_62804f1b69c60e0c7966cddd6_7c71fb81df" tabindex="-1" value=""></div>
      <div class="clear">
      <a href="http://eepurl.com/duztq5" target="_blank" id="mc-embedded-subscribe" class="button">Yes, I want to be a better developer!</a>
    </div>
  </div>
</div>

    </div>
    <div class="top-line">
      
        <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="https://karolgalanciak.com/blog/2017/09/24/do-or-do-not-there-is-no-try-object-number-try-considered-harmful/" data-via="Azdaroth" data-counturl="https://karolgalanciak.com/blog/2017/09/24/do-or-do-not-there-is-no-try-object-number-try-considered-harmful/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

      
    </div>
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2017/08/27/5-years-of-professional-ruby-and-rails-development-my-reflections/" title="Previous Post: 5 years of professional Ruby and Rails development - My Reflections">&laquo; 5 years of professional Ruby and Rails development - My Reflections</a>
      
      
        <a class="basic-alignment right" href="/blog/2017/10/29/the-case-against-exotic-usage-of-before-validate-callbacks/" title="Next Post: The Case Against Exotic Usage of :before_validate Callbacks">The Case Against Exotic Usage of :before_validate Callbacks &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <img class="left" src="/images/me_formal.jpg" title="me:)" alt="Karol Galanciak - photo">
  <p>Hi, my name is Karol Galanciak, I'm a technical polyglot and domain expert in vacation rental industry, taking it to the next level as CTO of <a href="https://www.bookingsync.com">BookingSync</a></p>

  <p>I specialize in building APIs, enterprise integration using message queues and distributed streaming, microservices architecture and working with legacy applications.</p>

  <p id="email-me"></p>
</section>

<script type="text/javascript">
  (function(d, id, lhs, rhs) {
    d.getElementById(id).innerHTML = "You can reach me at <a rel='nofollow' href='mailto:" + lhs + "@" + rhs + "'>" + lhs + "@" + rhs + "</a>";
  })(window.document, 'email-me', 'karol.galanciak', 'gmail.com');
</script>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2019/02/24/messages-on-rails-part-1-introduction-to-kafka-and-rabbitmq/">Messages on Rails Part 1 - Introduction to Kafka and RabbitMQ</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/01/27/how-to-tell-the-difference-between-a-default-and-provided-value-for-optional-arguments-in-ruby/">How to Tell the Difference Between a Default and a Provided Value for Optional Arguments in Ruby?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/12/16/inheritance-and-define-method-how-to-make-them-work-together/">Inheritance and Define_method - How to Make Them Work Together</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/09/30/the-problems-with-validating-activerecord-models-and-why-state-validation-is-a-bad-idea/">The Problems With Validating ActiveRecord Models and Why State Validation Is a Bad Idea</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/08/19/indexes-on-rails-how-to-make-the-most-of-your-postgres-database/">Indexes on Rails: How to Make the Most of Your Postgres Database</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/Azdaroth">@Azdaroth</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'Azdaroth',
            count: 6,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>

<section>
   <h1>Twitter</h1>
   <a class="twitter-timeline" href="https://twitter.com/Azdaroth" data-widget-id="357234540634329088">Tweets by @Azdaroth</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2019 - Karol Galanciak -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'karolgalanciak';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'https://karolgalanciak.com/blog/2017/09/24/do-or-do-not-there-is-no-try-object-number-try-considered-harmful/';
        var disqus_url = 'https://karolgalanciak.com/blog/2017/09/24/do-or-do-not-there-is-no-try-object-number-try-considered-harmful/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
