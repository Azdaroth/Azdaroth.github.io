
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Scaling Up Rails Applications With PostgreSQL Table Partitioning - Part 3 - Karol Galanciak - Ruby on Rails and Ember.js consultant</title>
  <meta name="author" content="Karol Galanciak">

  
  <meta name="description" content="Karol Galanciak - Ruby on Rails and Ember.js consultant, building ambitious and high performant web applications.">

  
  <meta name="keywords" content="Ruby on Rails, Ember.js, PostgreSQL, JavaScript, Consulting, MVP, post MVP, legacy apps">

  
  

  <meta property="og:title" value="Scaling Up Rails Applications With PostgreSQL Table Partitioning - Part 3 - Karol Galanciak - Ruby on Rails and Ember.js consultant" />
  <meta property="og:description" value="Karol Galanciak - Ruby on Rails and Ember.js consultant, building ambitious and high performant web applications." />
  <meta property="og:url" value="https://karolgalanciak.com/blog/2016/07/10/scaling-up-rails-applications-with-postgresql-table-partitioning-part-3/" />
  <meta property="og:type" content="website" />
  
  <meta property="og:site_name" content="Karol Galanciak - Ruby on Rails and Ember.js consultant"/>
  <meta property="og:locale" content="en_US" />

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@Azdaroth">
  <meta name="twitter:creator" content="@Azdaroth">
  <meta name="twitter:title" content="Scaling Up Rails Applications With PostgreSQL Table Partitioning - Part 3 - Karol Galanciak - Ruby on Rails and Ember.js consultant">
  <meta name="twitter:url" content="">
  <meta name="twitter:description" content="Karol Galanciak - Ruby on Rails and Ember.js consultant, building ambitious and high performant web applications.">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://karolgalanciak.com/blog/2016/07/10/scaling-up-rails-applications-with-postgresql-table-partitioning-part-3">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Karol Galanciak - Ruby on Rails and Ember.js consultant" type="application/atom+xml">
  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "BlogPosting",
      "mainEntityOfPage": {
        "@type":"WebPage",
        "@id": "https://karolgalanciak.com/blog/2016/07/10/scaling-up-rails-applications-with-postgresql-table-partitioning-part-3"
      },
      "headline": "Scaling Up Rails Applications With PostgreSQL Table Partitioning - Part 3 - Karol Galanciak - Ruby on Rails and Ember.js consultant",
        "image": {
        "@type": "ImageObject",
        "url": "",
        "height": 640,
        "width": 1024
      },
      "datePublished": "2016-07-10",
      "dateModified": "2019-02-25",
      "author": {
        "@type": "Person",
        "name": "Karol Galanciak"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Karol Galanciak",
        "logo": {
          "@type": "ImageObject",
          "url": "https://karolgalanciak.com/images/me_formal.jpg",
          "width": 600,
          "height": 60
        }
      },
      "description": "Karol Galanciak - Ruby on Rails and Ember.js consultant, building ambitious and high performant web applications.",
      "keywords": "Ruby on Rails, Ember.js, PostgreSQL, JavaScript, Consulting, MVP, post MVP, legacy apps"
    }
  </script>
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-42570582-1', 'auto');
    ga('send', 'pageview');
    ga('set', 'anonymizeIp', true);
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Karol Galanciak - Ruby on Rails and Ember.js consultant</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:karolgalanciak.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">About Me</a></li>
  <li><a href="/blog">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/test-driven-ember">Test-Driven Ember Book</a></li>
  <li><a href="/presentations">Presentations</a></li>
  <li><a href="/publications">Publications</a></li>
  <li><a href="/open-source">Open Source</a></li>
  <li><a href="/privacy-policy">Privacy Policy</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Scaling Up Rails Applications With PostgreSQL Table Partitioning - Part 3</h1>
    
    
      <p class="meta">
        








  


<time datetime="2016-07-10T23:50:00+02:00" pubdate data-updated="true">Jul 10<span>th</span>, 2016</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>After publishing recent blog posts about table partitioning - its <a href="https://karolgalanciak.com/blog/2016/06/05/scaling-up-rails-applications-with-postgresql-table-partitioning-part-1/" target="_blank">SQL basics part</a> and <a href="https://karolgalanciak.com/blog/2016/06/12/scaling-up-rails-applications-with-postgresql-table-partitioning-part-2/" target="_blank">how to use in in Rails application</a> I was asked quite a few times what is the real <b>performance gain</b> when using <strong>table partitioning</strong>. This is a great question, so let&#8217;s answer it by performing some benchmarks.</p>




<!--more-->




<h2>Setting up data for benchmarking</h2>




<p>As the table partitioning is intended to be used in Rails application, it makes most sense to perform benchmark with ActiveRecord&#8217;s overhead as well - we want to have some real-world comparison.</p>




<p>In the two previous parts we were discussing <code>orders</code> example, so let&#8217;s do the same here. We can start with generating model:</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">rails</span> <span class="n">generate</span> <span class="no">Order</span>
</span></code></pre></td></tr></table></div></figure>




<p>For benchmarking use case without table partitioning we don&#8217;t really need to change much, just add an index for <code>created_at</code> column:</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="k">class</span> <span class="nc">CreateOrders</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Migration</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">change</span>
</span><span class='line'>    <span class="n">create_table</span> <span class="ss">:orders</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">timestamps</span> <span class="ss">null</span><span class="p">:</span> <span class="kp">false</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">add_index</span> <span class="ss">:orders</span><span class="p">,</span> <span class="ss">:created_at</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>In case of partitioning, however, we need to set up some extra tables. We can reuse the examples from <a href="https://karolgalanciak.com/blog/2016/06/12/scaling-up-rails-applications-with-postgresql-table-partitioning-part-2/" target="_blank">part 2</a>. Let&#8217;s add the partitoned gem to the Gemfile:</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">gem</span> <span class="s1">&#39;activerecord-redshift-adapter&#39;</span><span class="p">,</span>  <span class="ss">git</span><span class="p">:</span> <span class="s2">&quot;git@github.com:arp/activerecord-redshift-adapter.git&quot;</span><span class="p">,</span> <span class="ss">branch</span><span class="p">:</span> <span class="s2">&quot;rails4-compatibility&quot;</span>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;partitioned&#39;</span><span class="p">,</span> <span class="ss">git</span><span class="p">:</span> <span class="s2">&quot;git@github.com:dkhofer/partitioned.git&quot;</span><span class="p">,</span> <span class="ss">branch</span><span class="p">:</span> <span class="s2">&quot;rails-4-2&quot;</span>
</span></code></pre></td></tr></table></div></figure>




<p>And set up <code>Order</code> model with the base class for partitioning by year (all the details are explained in <a href="https://karolgalanciak.com/blog/2016/06/12/scaling-up-rails-applications-with-postgresql-table-partitioning-part-2/" target="_blank">part 2</a>):</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="k">class</span> <span class="nc">PartitionedByCreatedAtYearly</span> <span class="o">&lt;</span> <span class="ss">Partitioned</span><span class="p">:</span><span class="ss">:ByYearlyTimeField</span>
</span><span class='line'>  <span class="nb">self</span><span class="o">.</span><span class="n">abstract_class</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">partition_time_field</span>
</span><span class='line'>    <span class="ss">:created_at</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">partitioned</span> <span class="k">do</span> <span class="o">|</span><span class="n">partition</span><span class="o">|</span>
</span><span class='line'>    <span class="n">partition</span><span class="o">.</span><span class="n">index</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">unique</span><span class="p">:</span> <span class="kp">true</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="k">class</span> <span class="nc">Order</span> <span class="o">&lt;</span> <span class="no">PartitionedByCreatedAtYearly</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>Finally, we can set up the migration:</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="k">class</span> <span class="nc">CreateOrders</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Migration</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">up</span>
</span><span class='line'>    <span class="n">create_table</span> <span class="ss">:orders</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
</span><span class='line'>      <span class="n">t</span><span class="o">.</span><span class="n">timestamps</span> <span class="ss">null</span><span class="p">:</span> <span class="kp">false</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">add_index</span> <span class="ss">:orders</span><span class="p">,</span> <span class="ss">:created_at</span>
</span><span class='line'>
</span><span class='line'>    <span class="no">Order</span><span class="o">.</span><span class="n">create_infrastructure</span>
</span><span class='line'>    <span class="n">dates</span> <span class="o">=</span> <span class="no">Order</span><span class="o">.</span><span class="n">partition_generate_range</span><span class="p">(</span><span class="no">Date</span><span class="o">.</span><span class="n">today</span><span class="p">,</span> <span class="no">Date</span><span class="o">.</span><span class="n">today</span> <span class="o">+</span> <span class="mi">4</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
</span><span class='line'>    <span class="no">Order</span><span class="o">.</span><span class="n">create_new_partition_tables</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">down</span>
</span><span class='line'>    <span class="no">Order</span><span class="o">.</span><span class="n">delete_infrastructure</span>
</span><span class='line'>    <span class="n">drop_table</span> <span class="ss">:orders</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>For sample data let&#8217;s start with creating 1 million orders for every year from 2016 to 2020. This should be enough to make the tables moderately big for real-world example and perform some meaningful benchmarking. Here&#8217;s the code to create these records with random date from given year: </p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">[</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">2017</span><span class="p">,</span> <span class="mi">2018</span><span class="p">,</span> <span class="mi">2019</span><span class="p">,</span> <span class="mi">2020</span><span class="o">].</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">current_year</span><span class="o">|</span>
</span><span class='line'>  <span class="n">dates_range</span> <span class="o">=</span> <span class="no">Date</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">current_year</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">.</span><span class="no">Date</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">current_year</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
</span><span class='line'>  <span class="no">Order</span><span class="o">.</span><span class="n">transaction</span> <span class="k">do</span>
</span><span class='line'>    <span class="mi">1000000</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
</span><span class='line'>      <span class="no">Order</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">created_at</span><span class="p">:</span> <span class="n">dates_range</span><span class="o">.</span><span class="n">to_a</span><span class="o">.</span><span class="n">sample</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>Don&#8217;t expect this one to finish fast ;).</p>




<p>To get even better idea about the performance difference, we could also test the queries with different amount of data. After each benchmark we could create additional 250 000 records for each year and rerun benchmarks. This could be reapeated until we reach 2 mln records in each table (10 mln in total) so that way we would have data for 5 different orders&#8217; amount.</p>




<h2>Benchmark methodology</h2>




<p>To have a meaningful benchmark that can be applicable to some real-world app, we need to test the queries that are likely to happen. For that purpose we can try selecting all orders, orders from particular year, from several years, from past few months and we could also try finding some orders with random id. We should also limit the amount of records we return, well, unless we want to kill the local machine ;). Counting the amount of orders for different date ranges would also be a nice addition. For partitioned tables we could also throw in some additional benchmarks comparing the performance between selecting orders from given partitioned child table and from master table and letting the PostgreSQL figure out how to handle the query (i.e. using constraint exclusion for filtering tables).</p>




<p>In this case we don&#8217;t really care about exact time for each query, but rather the ratio of query time (or iterations per seconds) for partitioned and not-partitioned table. Counting iterations per seconds for every query with <a href="https://github.com/evanphx/benchmark-ips">banchmark-ips</a> will be perfect for that. To calculate this ratio (let&#8217;s call it Partioned To Not Partioned Ratio) we would just need to divide the result from partitioned table by the result from non-partitioned table.</p>




<p>The amount of data is quite an important factor for this benchmark, especially with comparison to some <strong>PostgreSQL</strong> config settings. The size of orders table for different amount is the following:</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="mi">1</span><span class="p">,</span><span class="mo">00</span> <span class="n">mln</span> <span class="n">orders</span> <span class="n">each</span> <span class="o">-</span>  <span class="mi">5</span><span class="p">,</span><span class="mo">00</span> <span class="n">mln</span> <span class="n">total</span><span class="p">)</span> <span class="o">-</span> <span class="mi">249</span> <span class="no">MB</span>
</span><span class='line'><span class="mi">1</span><span class="p">,</span><span class="mi">25</span> <span class="n">mln</span> <span class="n">orders</span> <span class="n">each</span> <span class="o">-</span>  <span class="mi">6</span><span class="p">,</span><span class="mi">25</span> <span class="n">mln</span> <span class="n">total</span><span class="p">)</span> <span class="o">-</span> <span class="mi">311</span> <span class="no">MB</span>
</span><span class='line'><span class="mi">1</span><span class="p">,</span><span class="mi">50</span> <span class="n">mln</span> <span class="n">orders</span> <span class="n">each</span> <span class="o">-</span>  <span class="mi">7</span><span class="p">,</span><span class="mi">50</span> <span class="n">mln</span> <span class="n">total</span><span class="p">)</span> <span class="o">-</span> <span class="mi">373</span> <span class="no">MB</span>
</span><span class='line'><span class="mi">1</span><span class="p">,</span><span class="mi">75</span> <span class="n">mln</span> <span class="n">orders</span> <span class="n">each</span> <span class="o">-</span>  <span class="mi">8</span><span class="p">,</span><span class="mi">75</span> <span class="n">mln</span> <span class="n">total</span><span class="p">)</span> <span class="o">-</span> <span class="mi">436</span> <span class="no">MB</span>
</span><span class='line'><span class="mi">2</span><span class="p">,</span><span class="mo">00</span> <span class="n">mln</span> <span class="n">orders</span> <span class="n">each</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span><span class="mo">00</span> <span class="n">mln</span> <span class="n">total</span><span class="p">)</span> <span class="o">-</span> <span class="mi">498</span> <span class="no">MB</span>
</span></code></pre></td></tr></table></div></figure>




<p>These are the most essential config settings on my local machine which were used during the benchmark:</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">shared_buffers</span> <span class="o">=</span> <span class="mi">128</span><span class="no">MB</span>
</span><span class='line'><span class="n">temp_buffers</span> <span class="o">=</span> <span class="mi">8</span><span class="no">MB</span>
</span><span class='line'><span class="n">work_mem</span> <span class="o">=</span> <span class="mi">4</span><span class="no">MB</span>
</span><span class='line'><span class="n">maintenance_work_mem</span> <span class="o">=</span> <span class="mi">64</span><span class="no">MB</span>
</span><span class='line'><span class="n">constraint_exclusion</span> <span class="o">=</span> <span class="n">partition</span>
</span></code></pre></td></tr></table></div></figure>




<p>From our benchmark&#8217;s perspective, <code>shared_buffers</code> and <code>constraint_exclusion</code> parameters are the crucial ones - <code>shared_buffers</code>determines how much memory can be used for caching tables and <code>constraint_exclusion</code> will prevent scanning all child tables if the query conditions make it clear it is not required.</p>




<p>Here&#8217;s the final benchmark code, for patitioned tables:</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="nb">require</span> <span class="s1">&#39;benchmark/ips&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="no">Benchmark</span><span class="o">.</span><span class="n">ips</span> <span class="k">do</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="ss">time</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span> <span class="ss">warmup</span><span class="p">:</span> <span class="mi">2</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_all&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_all_count&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2016&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2016-01-01&#39; AND created_at &lt;= &#39;2016-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2016_count&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2016-01-01&#39; AND created_at &lt;= &#39;2016-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2016_partitioned&quot;</span><span class="p">)</span> <span class="p">{</span>  <span class="no">Order</span><span class="o">.</span><span class="n">from_partition</span><span class="p">(</span><span class="no">Date</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">2016</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2016_partitioned_count&quot;</span><span class="p">)</span> <span class="p">{</span>  <span class="no">Order</span><span class="o">.</span><span class="n">from_partition</span><span class="p">(</span><span class="no">Date</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">2016</span><span class="p">))</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2018&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2018-01-01&#39; AND created_at &lt;= &#39;2018-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2018_count&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2018-01-01&#39; AND created_at &lt;= &#39;2018-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2018_partitioned&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">from_partition</span><span class="p">(</span><span class="no">Date</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">2018</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2018_partitioned_count&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">from_partition</span><span class="p">(</span><span class="no">Date</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">2018</span><span class="p">))</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2020&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2020-01-01&#39; AND created_at &lt;= &#39;2020-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2020_count&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2020-01-01&#39; AND created_at &lt;= &#39;2020-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2020_partitioned&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">from_partition</span><span class="p">(</span><span class="no">Date</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">2020</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2020_partitioned_count&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">from_partition</span><span class="p">(</span><span class="no">Date</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">2020</span><span class="p">))</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2016_2019&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2016-01-01&#39; AND created_at &lt;= &#39;2019-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2016_2019_count&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2016-01-01&#39; AND created_at &lt;= &#39;2019-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2018_2020&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2018-01-01&#39; AND created_at &lt;= &#39;2020-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2018_2020_count&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2018-01-01&#39; AND created_at &lt;= &#39;2020-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_last_3_months&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= ?&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="o">.</span><span class="n">months</span><span class="o">.</span><span class="n">ago</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_last_3_months_count&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= ?&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="o">.</span><span class="n">months</span><span class="o">.</span><span class="n">ago</span><span class="p">)</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_last_6_months&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= ?&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="o">.</span><span class="n">months</span><span class="o">.</span><span class="n">ago</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_last_6_months_count&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= ?&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="o">.</span><span class="n">months</span><span class="o">.</span><span class="n">ago</span><span class="p">)</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_random_order&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="nb">rand</span><span class="p">(</span><span class="mi">5000000</span><span class="p">))</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">compare!</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>and for tables without partitioning:</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="nb">require</span> <span class="s1">&#39;benchmark/ips&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="no">Benchmark</span><span class="o">.</span><span class="n">ips</span> <span class="k">do</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="ss">time</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span> <span class="ss">warmup</span><span class="p">:</span> <span class="mi">2</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_all&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_all_count&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2016&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2016-01-01&#39; AND created_at &lt;= &#39;2016-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2016_count&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2016-01-01&#39; AND created_at &lt;= &#39;2016-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2018&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2018-01-01&#39; AND created_at &lt;= &#39;2018-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2018_count&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2018-01-01&#39; AND created_at &lt;= &#39;2018-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2020&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2020-01-01&#39; AND created_at &lt;= &#39;2020-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2020_count&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2020-01-01&#39; AND created_at &lt;= &#39;2020-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2016_2019&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2016-01-01&#39; AND created_at &lt;= &#39;2019-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2016_2019_count&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2016-01-01&#39; AND created_at &lt;= &#39;2019-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2018_2020&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2018-01-01&#39; AND created_at &lt;= &#39;2020-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_2018_2020_count&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= &#39;2018-01-01&#39; AND created_at &lt;= &#39;2020-12-31&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_last_3_months&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= ?&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="o">.</span><span class="n">months</span><span class="o">.</span><span class="n">ago</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_last_3_months_count&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= ?&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="o">.</span><span class="n">months</span><span class="o">.</span><span class="n">ago</span><span class="p">)</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_last_6_months&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= ?&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="o">.</span><span class="n">months</span><span class="o">.</span><span class="n">ago</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_last_6_months_count&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;created_at &gt;= ?&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="o">.</span><span class="n">months</span><span class="o">.</span><span class="n">ago</span><span class="p">)</span><span class="o">.</span><span class="n">count</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="s2">&quot;select_random_order&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="no">Order</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="nb">rand</span><span class="p">(</span><span class="mi">5000000</span><span class="p">))</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">x</span><span class="o">.</span><span class="n">compare!</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>Each operation will run for 45 seconds. We also need to include some warmup, otherwise the results would be less accurate.</p>




<h2>Benchmark results</h2>




<p>Here are the results of the benchmarks:</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">partitioned</span> <span class="n">with</span> <span class="mi">5</span> <span class="n">mln</span> <span class="n">orders</span> <span class="p">(</span><span class="mi">1</span> <span class="n">mln</span> <span class="n">orders</span> <span class="n">per</span> <span class="n">table</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="ss">Comparison</span><span class="p">:</span>
</span><span class='line'>
</span><span class='line'><span class="n">select_all</span><span class="p">:</span>                     <span class="mi">74897</span><span class="o">.</span><span class="mi">5</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span>
</span><span class='line'><span class="n">select_all_count</span><span class="p">:</span>               <span class="mi">1</span><span class="o">.</span><span class="mi">9</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">40047</span><span class="o">.</span><span class="mi">58</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016</span><span class="p">:</span>                    <span class="mi">44578</span><span class="o">.</span><span class="mi">5</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">68</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_count</span><span class="p">:</span>              <span class="mi">4</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">15640</span><span class="o">.</span><span class="mo">07</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_partitioned</span><span class="p">:</span>        <span class="mi">57904</span><span class="o">.</span><span class="mi">0</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">29</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_partitioned_count</span><span class="p">:</span>  <span class="mi">12</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">5882</span><span class="o">.</span><span class="mo">06</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018</span><span class="p">:</span>                    <span class="mi">45989</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">63</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_count</span><span class="p">:</span>              <span class="mi">4</span><span class="o">.</span><span class="mi">9</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">15263</span><span class="o">.</span><span class="mi">65</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_partitioned</span><span class="p">:</span>        <span class="mi">58718</span><span class="o">.</span><span class="mi">1</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">28</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_partitioned_count</span><span class="p">:</span>  <span class="mi">13</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">5475</span><span class="o">.</span><span class="mo">04</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020</span><span class="p">:</span>                    <span class="mi">49474</span><span class="o">.</span><span class="mi">6</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">51</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_count</span><span class="p">:</span>              <span class="mi">5</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">14206</span><span class="o">.</span><span class="mi">52</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_partitioned</span><span class="p">:</span>        <span class="mi">64135</span><span class="o">.</span><span class="mi">2</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">17</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_partitioned_count</span><span class="p">:</span>  <span class="mi">14</span><span class="o">.</span><span class="mi">1</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">5310</span><span class="o">.</span><span class="mi">68</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019</span><span class="p">:</span>               <span class="mi">49829</span><span class="o">.</span><span class="mi">4</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">50</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019_count</span><span class="p">:</span>         <span class="mi">1</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">58027</span><span class="o">.</span><span class="mi">53</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020</span><span class="p">:</span>               <span class="mi">49869</span><span class="o">.</span><span class="mi">1</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">50</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020_count</span><span class="p">:</span>         <span class="mi">1</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">43108</span><span class="o">.</span><span class="mi">82</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months</span><span class="p">:</span>           <span class="mi">3904</span><span class="o">.</span><span class="mi">2</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">19</span><span class="o">.</span><span class="mi">18</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months_count</span><span class="p">:</span>     <span class="mi">1</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">55527</span><span class="o">.</span><span class="mi">51</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months</span><span class="p">:</span>           <span class="mi">3909</span><span class="o">.</span><span class="mi">1</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">19</span><span class="o">.</span><span class="mi">16</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months_count</span><span class="p">:</span>     <span class="mi">1</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">56307</span><span class="o">.</span><span class="mi">51</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_random_order</span><span class="p">:</span>            <span class="mi">2629</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">28</span><span class="o">.</span><span class="mi">48</span><span class="n">x</span> <span class="n">slower</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">no</span> <span class="n">partitions</span> <span class="n">with</span> <span class="mi">5</span> <span class="n">mln</span> <span class="n">orders</span>
</span><span class='line'>
</span><span class='line'><span class="ss">Comparison</span><span class="p">:</span>
</span><span class='line'><span class="n">select_all</span><span class="p">:</span>                   <span class="mi">81600</span><span class="o">.</span><span class="mi">5</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span>
</span><span class='line'><span class="n">select_all_count</span><span class="p">:</span>             <span class="mi">2</span><span class="o">.</span><span class="mi">6</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">31546</span><span class="o">.</span><span class="mi">89</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016</span><span class="p">:</span>                  <span class="mi">50899</span><span class="o">.</span><span class="mi">1</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">60</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_count</span><span class="p">:</span>            <span class="mi">2</span><span class="o">.</span><span class="mi">4</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">34118</span><span class="o">.</span><span class="mi">71</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018</span><span class="p">:</span>                  <span class="mi">49785</span><span class="o">.</span><span class="mi">5</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">64</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_count</span><span class="p">:</span>            <span class="mi">2</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">35518</span><span class="o">.</span><span class="mi">36</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020</span><span class="p">:</span>                  <span class="mi">50353</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">62</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_count</span><span class="p">:</span>            <span class="mi">2</span><span class="o">.</span><span class="mi">2</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">36477</span><span class="o">.</span><span class="mi">64</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019</span><span class="p">:</span>             <span class="mi">50161</span><span class="o">.</span><span class="mi">9</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">63</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019_count</span><span class="p">:</span>       <span class="mi">1</span><span class="o">.</span><span class="mi">2</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">69940</span><span class="o">.</span><span class="mi">19</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020</span><span class="p">:</span>             <span class="mi">50317</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">62</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020_count</span><span class="p">:</span>       <span class="mi">1</span><span class="o">.</span><span class="mi">4</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">59057</span><span class="o">.</span><span class="mo">02</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months</span><span class="p">:</span>         <span class="mi">3907</span><span class="o">.</span><span class="mi">2</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">20</span><span class="o">.</span><span class="mi">88</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months_count</span><span class="p">:</span>   <span class="mi">1</span><span class="o">.</span><span class="mi">5</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">55355</span><span class="o">.</span><span class="mi">65</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months</span><span class="p">:</span>         <span class="mi">3904</span><span class="o">.</span><span class="mi">1</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">20</span><span class="o">.</span><span class="mi">90</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months_count</span><span class="p">:</span>   <span class="mi">1</span><span class="o">.</span><span class="mi">5</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">54201</span><span class="o">.</span><span class="mi">25</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_random_order</span><span class="p">:</span>          <span class="mi">2395</span><span class="o">.</span><span class="mi">9</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">34</span><span class="o">.</span><span class="mo">06</span><span class="n">x</span> <span class="n">slower</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">partitioned</span> <span class="n">with</span> <span class="mi">6</span><span class="p">,</span><span class="mi">25</span> <span class="n">mln</span> <span class="n">orders</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span> <span class="n">mln</span> <span class="n">orders</span> <span class="n">per</span> <span class="n">table</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="ss">Comparison</span><span class="p">:</span>
</span><span class='line'><span class="n">select_all</span><span class="p">:</span>                     <span class="mi">73717</span><span class="o">.</span><span class="mi">9</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span>
</span><span class='line'><span class="n">select_all_count</span><span class="p">:</span>               <span class="mi">1</span><span class="o">.</span><span class="mi">4</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">51747</span><span class="o">.</span><span class="mi">39</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016</span><span class="p">:</span>                    <span class="mi">44895</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">64</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_count</span><span class="p">:</span>              <span class="mi">3</span><span class="o">.</span><span class="mi">9</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">19133</span><span class="o">.</span><span class="mo">01</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_partitioned</span><span class="p">:</span>        <span class="mi">57672</span><span class="o">.</span><span class="mi">1</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">28</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_partitioned_count</span><span class="p">:</span>  <span class="mi">10</span><span class="o">.</span><span class="mi">2</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">7211</span><span class="o">.</span><span class="mi">72</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018</span><span class="p">:</span>                    <span class="mi">45076</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">64</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_count</span><span class="p">:</span>              <span class="mi">3</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">19909</span><span class="o">.</span><span class="mi">78</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_partitioned</span><span class="p">:</span>        <span class="mi">57480</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">28</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_partitioned_count</span><span class="p">:</span>  <span class="mi">10</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">7177</span><span class="o">.</span><span class="mi">85</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020</span><span class="p">:</span>                    <span class="mi">44549</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">65</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_count</span><span class="p">:</span>              <span class="mi">3</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">19585</span><span class="o">.</span><span class="mi">29</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_partitioned</span><span class="p">:</span>        <span class="mi">58816</span><span class="o">.</span><span class="mi">4</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">25</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_partitioned_count</span><span class="p">:</span>  <span class="mi">10</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">7167</span><span class="o">.</span><span class="mi">61</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019</span><span class="p">:</span>               <span class="mi">45154</span><span class="o">.</span><span class="mi">9</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">63</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019_count</span><span class="p">:</span>         <span class="mi">0</span><span class="o">.</span><span class="mi">9</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">78001</span><span class="o">.</span><span class="mi">75</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020</span><span class="p">:</span>               <span class="mi">44243</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">67</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020_count</span><span class="p">:</span>         <span class="mi">1</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">57270</span><span class="o">.</span><span class="mi">76</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months</span><span class="p">:</span>           <span class="mi">3607</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">20</span><span class="o">.</span><span class="mi">44</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months_count</span><span class="p">:</span>     <span class="mi">1</span><span class="o">.</span><span class="mi">0</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">72969</span><span class="o">.</span><span class="mi">17</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months</span><span class="p">:</span>           <span class="mi">3650</span><span class="o">.</span><span class="mi">9</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">20</span><span class="o">.</span><span class="mi">19</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months_count</span><span class="p">:</span>     <span class="mi">1</span><span class="o">.</span><span class="mi">0</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">73116</span><span class="o">.</span><span class="mi">36</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_random_order</span><span class="p">:</span>            <span class="mi">2734</span><span class="o">.</span><span class="mi">6</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">26</span><span class="o">.</span><span class="mi">96</span><span class="n">x</span> <span class="n">slower</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">no</span> <span class="n">partitions</span> <span class="n">with</span> <span class="mi">6</span><span class="p">,</span><span class="mi">25</span> <span class="n">mln</span> <span class="n">orders</span>
</span><span class='line'>
</span><span class='line'><span class="ss">Comparison</span><span class="p">:</span>
</span><span class='line'><span class="n">select_all</span><span class="p">:</span>                    <span class="mi">81474</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span>
</span><span class='line'><span class="n">select_all_count</span><span class="p">:</span>              <span class="mi">2</span><span class="o">.</span><span class="mi">0</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">40681</span><span class="o">.</span><span class="mi">89</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016</span><span class="p">:</span>                   <span class="mi">51134</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">59</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_count</span><span class="p">:</span>             <span class="mi">4</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">17008</span><span class="o">.</span><span class="mi">37</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018</span><span class="p">:</span>                   <span class="mi">51037</span><span class="o">.</span><span class="mi">4</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">60</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_count</span><span class="p">:</span>             <span class="mi">4</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">16942</span><span class="o">.</span><span class="mi">96</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020</span><span class="p">:</span>                   <span class="mi">51078</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">60</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_count</span><span class="p">:</span>             <span class="mi">4</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">17054</span><span class="o">.</span><span class="mi">96</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019</span><span class="p">:</span>              <span class="mi">50950</span><span class="o">.</span><span class="mi">0</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">60</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019_count</span><span class="p">:</span>        <span class="mi">0</span><span class="o">.</span><span class="mi">9</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">86364</span><span class="o">.</span><span class="mi">33</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020</span><span class="p">:</span>              <span class="mi">50587</span><span class="o">.</span><span class="mi">6</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">61</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020_count</span><span class="p">:</span>        <span class="mi">1</span><span class="o">.</span><span class="mi">1</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">72926</span><span class="o">.</span><span class="mi">49</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months</span><span class="p">:</span>          <span class="mi">3889</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">20</span><span class="o">.</span><span class="mi">95</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months_count</span><span class="p">:</span>    <span class="mi">1</span><span class="o">.</span><span class="mi">2</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">67447</span><span class="o">.</span><span class="mi">88</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months</span><span class="p">:</span>          <span class="mi">3917</span><span class="o">.</span><span class="mi">4</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">20</span><span class="o">.</span><span class="mi">80</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months_count</span><span class="p">:</span>    <span class="mi">1</span><span class="o">.</span><span class="mi">2</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">67757</span><span class="o">.</span><span class="mi">10</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_random_order</span><span class="p">:</span>           <span class="mi">3052</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">26</span><span class="o">.</span><span class="mi">69</span><span class="n">x</span> <span class="n">slower</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">partitioned</span> <span class="n">with</span> <span class="mi">7</span><span class="p">,</span><span class="mi">5</span> <span class="n">mln</span> <span class="n">orders</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span> <span class="n">mln</span> <span class="n">orders</span> <span class="n">per</span> <span class="n">table</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="ss">Comparison</span><span class="p">:</span>
</span><span class='line'><span class="n">select_all</span><span class="p">:</span>                      <span class="mi">73455</span><span class="o">.</span><span class="mi">4</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span>
</span><span class='line'><span class="n">select_all_count</span><span class="p">:</span>                <span class="mi">1</span><span class="o">.</span><span class="mi">2</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">60875</span><span class="o">.</span><span class="mi">32</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016</span><span class="p">:</span>                     <span class="mi">45358</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">62</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_count</span><span class="p">:</span>               <span class="mi">3</span><span class="o">.</span><span class="mi">2</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">23066</span><span class="o">.</span><span class="mi">47</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_partitioned</span><span class="p">:</span>         <span class="mi">57730</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">27</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_partitioned_count</span><span class="p">:</span>   <span class="mi">9</span><span class="o">.</span><span class="mi">0</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">8161</span><span class="o">.</span><span class="mi">54</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018</span><span class="p">:</span>                     <span class="mi">47094</span><span class="o">.</span><span class="mi">5</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">56</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_count</span><span class="p">:</span>               <span class="mi">3</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">22478</span><span class="o">.</span><span class="mo">03</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_partitioned</span><span class="p">:</span>         <span class="mi">59741</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">23</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_partitioned_count</span><span class="p">:</span>   <span class="mi">8</span><span class="o">.</span><span class="mi">9</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">8289</span><span class="o">.</span><span class="mi">60</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020</span><span class="p">:</span>                     <span class="mi">46247</span><span class="o">.</span><span class="mi">4</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">59</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_count</span><span class="p">:</span>               <span class="mi">3</span><span class="o">.</span><span class="mi">2</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">23056</span><span class="o">.</span><span class="mi">21</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_partitioned</span><span class="p">:</span>         <span class="mi">58764</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">25</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_partitioned_count</span><span class="p">:</span>   <span class="mi">8</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">8318</span><span class="o">.</span><span class="mi">22</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019</span><span class="p">:</span>                <span class="mi">44424</span><span class="o">.</span><span class="mi">4</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">65</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019_count</span><span class="p">:</span>          <span class="mi">0</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">94546</span><span class="o">.</span><span class="mi">45</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020</span><span class="p">:</span>                <span class="mi">45202</span><span class="o">.</span><span class="mi">2</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">63</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020_count</span><span class="p">:</span>          <span class="mi">1</span><span class="o">.</span><span class="mi">1</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">68131</span><span class="o">.</span><span class="mi">10</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months</span><span class="p">:</span>            <span class="mi">3530</span><span class="o">.</span><span class="mi">4</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">20</span><span class="o">.</span><span class="mi">81</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months_count</span><span class="p">:</span>      <span class="mi">0</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">89367</span><span class="o">.</span><span class="mi">97</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months</span><span class="p">:</span>            <span class="mi">3473</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">21</span><span class="o">.</span><span class="mi">15</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months_count</span><span class="p">:</span>      <span class="mi">0</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">92414</span><span class="o">.</span><span class="mi">10</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_random_order</span><span class="p">:</span>             <span class="mi">1224</span><span class="o">.</span><span class="mi">6</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">59</span><span class="o">.</span><span class="mi">98</span><span class="n">x</span> <span class="n">slower</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">no</span> <span class="n">partitions</span> <span class="n">with</span> <span class="mi">7</span><span class="p">,</span><span class="mi">5</span> <span class="n">mln</span> <span class="n">orders</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="ss">Comparison</span><span class="p">:</span>
</span><span class='line'><span class="n">select_all</span><span class="p">:</span>                   <span class="mi">81357</span><span class="o">.</span><span class="mi">1</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span>
</span><span class='line'><span class="n">select_all_count</span><span class="p">:</span>             <span class="mi">1</span><span class="o">.</span><span class="mi">6</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">52303</span><span class="o">.</span><span class="mi">23</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016</span><span class="p">:</span>                  <span class="mi">45865</span><span class="o">.</span><span class="mi">5</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">77</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_count</span><span class="p">:</span>            <span class="mi">3</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">21673</span><span class="o">.</span><span class="mi">22</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018</span><span class="p">:</span>                  <span class="mi">49084</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">66</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_count</span><span class="p">:</span>            <span class="mi">3</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">21837</span><span class="o">.</span><span class="mi">91</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020</span><span class="p">:</span>                  <span class="mi">48963</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">66</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_count</span><span class="p">:</span>            <span class="mi">3</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">21364</span><span class="o">.</span><span class="mi">75</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019</span><span class="p">:</span>             <span class="mi">49560</span><span class="o">.</span><span class="mi">5</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">64</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019_count</span><span class="p">:</span>       <span class="mi">0</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">109331</span><span class="o">.</span><span class="mi">83</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020</span><span class="p">:</span>             <span class="mi">47704</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">71</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020_count</span><span class="p">:</span>       <span class="mi">0</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">96387</span><span class="o">.</span><span class="mi">27</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months</span><span class="p">:</span>         <span class="mi">3614</span><span class="o">.</span><span class="mi">5</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">22</span><span class="o">.</span><span class="mi">51</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months_count</span><span class="p">:</span>   <span class="mi">0</span><span class="o">.</span><span class="mi">9</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">88464</span><span class="o">.</span><span class="mi">34</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months</span><span class="p">:</span>         <span class="mi">3732</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">21</span><span class="o">.</span><span class="mi">80</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months_count</span><span class="p">:</span>   <span class="mi">0</span><span class="o">.</span><span class="mi">9</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">85721</span><span class="o">.</span><span class="mo">04</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_random_order</span><span class="p">:</span>          <span class="mi">2433</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">33</span><span class="o">.</span><span class="mi">43</span><span class="n">x</span> <span class="n">slower</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">partitioned</span> <span class="n">with</span> <span class="mi">8</span><span class="p">,</span><span class="mi">75</span> <span class="n">mln</span> <span class="n">orders</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">75</span> <span class="n">mln</span> <span class="n">orders</span> <span class="n">per</span> <span class="n">table</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="ss">Comparison</span><span class="p">:</span>
</span><span class='line'><span class="n">select_all</span><span class="p">:</span>                      <span class="mi">69684</span><span class="o">.</span><span class="mi">2</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span>
</span><span class='line'><span class="n">select_all_count</span><span class="p">:</span>                <span class="mi">1</span><span class="o">.</span><span class="mi">0</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">68219</span><span class="o">.</span><span class="mi">96</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016</span><span class="p">:</span>                     <span class="mi">44071</span><span class="o">.</span><span class="mi">1</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">58</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_count</span><span class="p">:</span>               <span class="mi">2</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">26202</span><span class="o">.</span><span class="mi">73</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_partitioned</span><span class="p">:</span>         <span class="mi">56547</span><span class="o">.</span><span class="mi">4</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">23</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_partitioned_count</span><span class="p">:</span>   <span class="mi">7</span><span class="o">.</span><span class="mi">1</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">9790</span><span class="o">.</span><span class="mi">82</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018</span><span class="p">:</span>                     <span class="mi">44275</span><span class="o">.</span><span class="mi">5</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">57</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_count</span><span class="p">:</span>               <span class="mi">2</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">25299</span><span class="o">.</span><span class="mi">18</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_partitioned</span><span class="p">:</span>         <span class="mi">59494</span><span class="o">.</span><span class="mi">0</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">17</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_partitioned_count</span><span class="p">:</span>   <span class="mi">7</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">8963</span><span class="o">.</span><span class="mi">99</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020</span><span class="p">:</span>                     <span class="mi">48330</span><span class="o">.</span><span class="mi">6</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">44</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_count</span><span class="p">:</span>               <span class="mi">2</span><span class="o">.</span><span class="mi">9</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">24392</span><span class="o">.</span><span class="mi">21</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_partitioned</span><span class="p">:</span>         <span class="mi">61583</span><span class="o">.</span><span class="mi">6</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">13</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_partitioned_count</span><span class="p">:</span>   <span class="mi">7</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">9056</span><span class="o">.</span><span class="mi">91</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019</span><span class="p">:</span>                <span class="mi">48135</span><span class="o">.</span><span class="mi">1</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">45</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019_count</span><span class="p">:</span>          <span class="mi">0</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">100006</span><span class="o">.</span><span class="mi">51</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020</span><span class="p">:</span>                <span class="mi">47873</span><span class="o">.</span><span class="mi">0</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">46</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020_count</span><span class="p">:</span>          <span class="mi">1</span><span class="o">.</span><span class="mi">0</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">72089</span><span class="o">.</span><span class="mi">48</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months</span><span class="p">:</span>            <span class="mi">3789</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">18</span><span class="o">.</span><span class="mi">39</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months_count</span><span class="p">:</span>      <span class="mi">0</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">93772</span><span class="o">.</span><span class="mi">85</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months</span><span class="p">:</span>            <span class="mi">3743</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">18</span><span class="o">.</span><span class="mi">61</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months_count</span><span class="p">:</span>      <span class="mi">0</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">104123</span><span class="o">.</span><span class="mi">34</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_random_order</span><span class="p">:</span>             <span class="mi">1594</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">43</span><span class="o">.</span><span class="mi">70</span><span class="n">x</span> <span class="n">slower</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">no</span> <span class="n">partitions</span> <span class="n">with</span> <span class="mi">8</span><span class="p">,</span><span class="mi">75</span> <span class="n">mln</span> <span class="n">orders</span>
</span><span class='line'>
</span><span class='line'><span class="ss">Comparison</span><span class="p">:</span>
</span><span class='line'><span class="n">select_all</span><span class="p">:</span>                    <span class="mi">78650</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span>
</span><span class='line'><span class="n">select_all_count</span><span class="p">:</span>              <span class="mi">1</span><span class="o">.</span><span class="mi">4</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">57896</span><span class="o">.</span><span class="mi">82</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016</span><span class="p">:</span>                   <span class="mi">49334</span><span class="o">.</span><span class="mi">2</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">59</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_count</span><span class="p">:</span>             <span class="mi">2</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">28319</span><span class="o">.</span><span class="mi">15</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018</span><span class="p">:</span>                   <span class="mi">49795</span><span class="o">.</span><span class="mi">5</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">58</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_count</span><span class="p">:</span>             <span class="mi">2</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">27838</span><span class="o">.</span><span class="mi">51</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020</span><span class="p">:</span>                   <span class="mi">49627</span><span class="o">.</span><span class="mi">9</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">58</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_count</span><span class="p">:</span>             <span class="mi">2</span><span class="o">.</span><span class="mi">9</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">27517</span><span class="o">.</span><span class="mi">70</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019</span><span class="p">:</span>              <span class="mi">50133</span><span class="o">.</span><span class="mi">2</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">57</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019_count</span><span class="p">:</span>        <span class="mi">0</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">118255</span><span class="o">.</span><span class="mi">69</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020</span><span class="p">:</span>              <span class="mi">49375</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">59</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020_count</span><span class="p">:</span>        <span class="mi">0</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">108822</span><span class="o">.</span><span class="mi">92</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months</span><span class="p">:</span>          <span class="mi">3574</span><span class="o">.</span><span class="mi">1</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">22</span><span class="o">.</span><span class="mo">01</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months_count</span><span class="p">:</span>    <span class="mi">0</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">97753</span><span class="o">.</span><span class="mi">55</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months</span><span class="p">:</span>          <span class="mi">3562</span><span class="o">.</span><span class="mi">1</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">22</span><span class="o">.</span><span class="mi">08</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months_count</span><span class="p">:</span>    <span class="mi">0</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">99605</span><span class="o">.</span><span class="mi">90</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_random_order</span><span class="p">:</span>           <span class="mi">3419</span><span class="o">.</span><span class="mi">0</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">23</span><span class="o">.</span><span class="mo">00</span><span class="n">x</span> <span class="n">slower</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">partitioned</span> <span class="n">with</span> <span class="mi">10</span> <span class="n">mln</span> <span class="n">orders</span> <span class="p">(</span><span class="mi">2</span> <span class="n">mln</span> <span class="n">orders</span> <span class="n">per</span> <span class="n">table</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="ss">Comparison</span><span class="p">:</span>
</span><span class='line'><span class="n">select_all</span><span class="p">:</span>                      <span class="mi">73071</span><span class="o">.</span><span class="mi">4</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span>
</span><span class='line'><span class="n">select_all_count</span><span class="p">:</span>                <span class="mi">0</span><span class="o">.</span><span class="mi">9</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">77393</span><span class="o">.</span><span class="mi">87</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016</span><span class="p">:</span>                     <span class="mi">46767</span><span class="o">.</span><span class="mi">5</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">56</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_count</span><span class="p">:</span>               <span class="mi">2</span><span class="o">.</span><span class="mi">5</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">29518</span><span class="o">.</span><span class="mi">12</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_partitioned</span><span class="p">:</span>         <span class="mi">59404</span><span class="o">.</span><span class="mi">4</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">23</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_partitioned_count</span><span class="p">:</span>   <span class="mi">6</span><span class="o">.</span><span class="mi">6</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">11005</span><span class="o">.</span><span class="mi">71</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018</span><span class="p">:</span>                     <span class="mi">47674</span><span class="o">.</span><span class="mi">2</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">53</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_count</span><span class="p">:</span>               <span class="mi">2</span><span class="o">.</span><span class="mi">4</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">30309</span><span class="o">.</span><span class="mi">30</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_partitioned</span><span class="p">:</span>         <span class="mi">58371</span><span class="o">.</span><span class="mi">9</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">25</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_partitioned_count</span><span class="p">:</span>   <span class="mi">6</span><span class="o">.</span><span class="mi">5</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">11256</span><span class="o">.</span><span class="mi">61</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020</span><span class="p">:</span>                     <span class="mi">46546</span><span class="o">.</span><span class="mi">0</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">57</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_count</span><span class="p">:</span>               <span class="mi">2</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">31198</span><span class="o">.</span><span class="mi">92</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_partitioned</span><span class="p">:</span>         <span class="mi">58862</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">24</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_partitioned_count</span><span class="p">:</span>   <span class="mi">6</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">11672</span><span class="o">.</span><span class="mi">16</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019</span><span class="p">:</span>                <span class="mi">46781</span><span class="o">.</span><span class="mi">4</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">56</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019_count</span><span class="p">:</span>          <span class="mi">0</span><span class="o">.</span><span class="mi">6</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">122988</span><span class="o">.</span><span class="mo">06</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020</span><span class="p">:</span>                <span class="mi">46147</span><span class="o">.</span><span class="mi">2</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">58</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020_count</span><span class="p">:</span>          <span class="mi">0</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">90296</span><span class="o">.</span><span class="mi">27</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months</span><span class="p">:</span>            <span class="mi">3699</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">19</span><span class="o">.</span><span class="mi">75</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months_count</span><span class="p">:</span>      <span class="mi">0</span><span class="o">.</span><span class="mi">6</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">116559</span><span class="o">.</span><span class="mi">31</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months</span><span class="p">:</span>            <span class="mi">3716</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">19</span><span class="o">.</span><span class="mi">66</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months_count</span><span class="p">:</span>      <span class="mi">0</span><span class="o">.</span><span class="mi">6</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">121600</span><span class="o">.</span><span class="mo">00</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_random_order</span><span class="p">:</span>             <span class="mi">1548</span><span class="o">.</span><span class="mi">6</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">47</span><span class="o">.</span><span class="mi">19</span><span class="n">x</span> <span class="n">slower</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">no</span> <span class="n">partitions</span> <span class="n">with</span> <span class="mi">10</span> <span class="n">mln</span> <span class="n">orders</span>
</span><span class='line'>
</span><span class='line'><span class="ss">Comparison</span><span class="p">:</span>
</span><span class='line'><span class="n">select_all</span><span class="p">:</span>                    <span class="mi">77376</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span>
</span><span class='line'><span class="n">select_all_count</span><span class="p">:</span>              <span class="mi">1</span><span class="o">.</span><span class="mi">2</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">66625</span><span class="o">.</span><span class="mo">00</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016</span><span class="p">:</span>                   <span class="mi">46285</span><span class="o">.</span><span class="mi">5</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">67</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_count</span><span class="p">:</span>             <span class="mi">2</span><span class="o">.</span><span class="mi">3</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">33061</span><span class="o">.</span><span class="mi">51</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018</span><span class="p">:</span>                   <span class="mi">47121</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">64</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_count</span><span class="p">:</span>             <span class="mi">2</span><span class="o">.</span><span class="mi">4</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">32082</span><span class="o">.</span><span class="mi">74</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020</span><span class="p">:</span>                   <span class="mi">50322</span><span class="o">.</span><span class="mi">0</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">54</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2020_count</span><span class="p">:</span>             <span class="mi">2</span><span class="o">.</span><span class="mi">5</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">31443</span><span class="o">.</span><span class="mi">35</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019</span><span class="p">:</span>              <span class="mi">48615</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">59</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2016_2019_count</span><span class="p">:</span>        <span class="mi">0</span><span class="o">.</span><span class="mi">6</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">135045</span><span class="o">.</span><span class="mi">30</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020</span><span class="p">:</span>              <span class="mi">49185</span><span class="o">.</span><span class="mi">5</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="o">.</span><span class="mi">57</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_2018_2020_count</span><span class="p">:</span>        <span class="mi">0</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">114814</span><span class="o">.</span><span class="mi">42</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months</span><span class="p">:</span>          <span class="mi">3781</span><span class="o">.</span><span class="mi">1</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">20</span><span class="o">.</span><span class="mi">46</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_3_months_count</span><span class="p">:</span>    <span class="mi">0</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">106257</span><span class="o">.</span><span class="mi">71</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months</span><span class="p">:</span>          <span class="mi">3737</span><span class="o">.</span><span class="mi">8</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">20</span><span class="o">.</span><span class="mi">70</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_last_6_months_count</span><span class="p">:</span>    <span class="mi">0</span><span class="o">.</span><span class="mi">7</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">107643</span><span class="o">.</span><span class="mo">07</span><span class="n">x</span> <span class="n">slower</span>
</span><span class='line'><span class="n">select_random_order</span><span class="p">:</span>           <span class="mi">3655</span><span class="o">.</span><span class="mi">0</span> <span class="n">i</span><span class="o">/</span><span class="n">s</span> <span class="o">-</span> <span class="mi">21</span><span class="o">.</span><span class="mi">17</span><span class="n">x</span> <span class="n">slower</span>
</span></code></pre></td></tr></table></div></figure>




<p>That way we&#8217;ve obtained iterations per second for different queries. Let&#8217;s calculate now the ratio of query time for partitionied and not partitioned table. To get the better idea about the relation between the ratios for different orders&#8217; amount, I put the results on the graph (due to the proportions you may want to see them in better quality by clicking the link below each graph).</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span> <span class="no">Select</span> <span class="no">All</span> <span class="no">Partitioned</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|-------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                    <span class="mi">0</span><span class="p">,</span><span class="mi">917</span>                        <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                    <span class="mi">0</span><span class="p">,</span><span class="mi">905</span>                        <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                    <span class="mi">0</span><span class="p">,</span><span class="mi">903</span>                        <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                    <span class="mi">0</span><span class="p">,</span><span class="mi">886</span>                        <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                    <span class="mi">0</span><span class="p">,</span><span class="mi">944</span>                        <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_all_graph.png" title="select_all_graph" alt="select_all_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_all_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="no">All</span> <span class="no">Count</span> <span class="no">Partitioned</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|--------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                      <span class="mi">0</span><span class="p">,</span><span class="mi">731</span>                             <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                      <span class="mi">0</span><span class="p">,</span><span class="mi">700</span>                             <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                      <span class="mi">0</span><span class="p">,</span><span class="mi">750</span>                             <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                      <span class="mi">0</span><span class="p">,</span><span class="mi">714</span>                             <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                      <span class="mi">0</span><span class="p">,</span><span class="mi">750</span>                             <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_all_count_graph.png" title="select_all_count" alt="select_all_count"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_all_count_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2016</span> <span class="no">Partitioned</span> <span class="p">(</span><span class="n">master</span> <span class="n">table</span><span class="p">)</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|------------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                         <span class="mi">0</span><span class="p">,</span><span class="mi">876</span>                                    <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                         <span class="mi">0</span><span class="p">,</span><span class="mi">878</span>                                    <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                         <span class="mi">0</span><span class="p">,</span><span class="mi">989</span>                                    <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                         <span class="mi">0</span><span class="p">,</span><span class="mi">893</span>                                    <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                         <span class="mi">1</span><span class="p">,</span><span class="mo">010</span>                                    <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2016_p_to_np_master_graph.png" title="select_2016_p_to_np_master_graph" alt="select_2016_p_to_np_master_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2016_p_to_np_master_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2016</span> <span class="no">Partitioned</span> <span class="p">(</span><span class="n">child</span> <span class="n">table</span><span class="p">)</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span>  <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|------------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                         <span class="mi">1</span><span class="p">,</span><span class="mi">138</span>                                    <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                         <span class="mi">1</span><span class="p">,</span><span class="mi">128</span>                                    <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                         <span class="mi">1</span><span class="p">,</span><span class="mi">259</span>                                    <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                         <span class="mi">1</span><span class="p">,</span><span class="mi">146</span>                                    <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                         <span class="mi">1</span><span class="p">,</span><span class="mi">283</span>                                    <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2016_p_to_np_child_graph.png" title="select_2016_p_to_np_child_graph" alt="select_2016_p_to_np_child_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2016_p_to_np_child_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2016</span> <span class="no">Partitioned</span> <span class="p">(</span><span class="n">child</span> <span class="n">table</span><span class="p">)</span> <span class="no">To</span> <span class="no">Master</span> <span class="no">Table</span> <span class="no">Ratio</span>       <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|--------------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                         <span class="mi">1</span><span class="p">,</span><span class="mi">299</span>                                      <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                         <span class="mi">1</span><span class="p">,</span><span class="mi">285</span>                                      <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                         <span class="mi">1</span><span class="p">,</span><span class="mi">273</span>                                      <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                         <span class="mi">1</span><span class="p">,</span><span class="mi">283</span>                                      <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                         <span class="mi">1</span><span class="p">,</span><span class="mi">270</span>                                      <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2016_p_to_p_graph.png" title="select_2016_p_to_p_graph" alt="select_2016_p_to_p_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2016_p_to_p_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2016</span> <span class="no">Count</span> <span class="no">Partitioned</span> <span class="p">(</span><span class="n">master</span> <span class="n">table</span><span class="p">)</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|------------------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                            <span class="mi">2</span><span class="p">,</span><span class="mo">000</span>                                       <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">813</span>                                       <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">842</span>                                       <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">964</span>                                       <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                            <span class="mi">1</span><span class="p">,</span><span class="mi">087</span>                                       <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2016_count_p_to_np_master_graph.png" title="select_2016_count_p_to_np_master_graph" alt="select_2016_count_p_to_np_master_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2016_count_p_to_np_master_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2016</span> <span class="no">Count</span> <span class="no">Partitioned</span> <span class="p">(</span><span class="n">child</span> <span class="n">table</span><span class="p">)</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|-----------------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                                <span class="mi">5</span><span class="p">,</span><span class="mi">292</span>                                  <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                                <span class="mi">2</span><span class="p">,</span><span class="mi">125</span>                                  <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                                <span class="mi">2</span><span class="p">,</span><span class="mi">368</span>                                  <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                                <span class="mi">2</span><span class="p">,</span><span class="mi">536</span>                                  <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                                <span class="mi">2</span><span class="p">,</span><span class="mi">870</span>                                  <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2016_count_p_to_np_child_graph.png" title="select_2016_count_p_to_np_child_graph" alt="select_2016_count_p_to_np_child_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2016_count_p_to_np_child_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2016</span> <span class="no">Count</span> <span class="no">Partitioned</span> <span class="p">(</span><span class="n">child</span> <span class="n">table</span><span class="p">)</span> <span class="no">To</span> <span class="no">Master</span> <span class="no">Table</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|--------------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                               <span class="mi">2</span><span class="p">,</span><span class="mi">649</span>                                <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                               <span class="mi">2</span><span class="p">,</span><span class="mi">615</span>                                <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                               <span class="mi">2</span><span class="p">,</span><span class="mi">813</span>                                <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                               <span class="mi">2</span><span class="p">,</span><span class="mi">630</span>                                <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                               <span class="mi">2</span><span class="p">,</span><span class="mi">640</span>                                <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2016_count_p_to_p_graph.png" title="select_2016_count_p_to_p_graph" alt="select_2016_count_p_to_p_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2016_count_p_to_p_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2018</span> <span class="no">Partitioned</span> <span class="p">(</span><span class="n">master</span> <span class="n">table</span><span class="p">)</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|------------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                          <span class="mi">0</span><span class="p">,</span><span class="mi">924</span>                                   <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                          <span class="mi">0</span><span class="p">,</span><span class="mi">883</span>                                   <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                          <span class="mi">0</span><span class="p">,</span><span class="mi">959</span>                                   <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                          <span class="mi">0</span><span class="p">,</span><span class="mi">889</span>                                   <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                          <span class="mi">1</span><span class="p">,</span><span class="mo">012</span>                                   <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2018_p_to_np_master_graph.png" title="select_2018_p_to_np_master_graph" alt="select_2018_p_to_np_master_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2018_p_to_np_master_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2018</span> <span class="no">Partitioned</span> <span class="p">(</span><span class="n">child</span> <span class="n">table</span><span class="p">)</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|-----------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                           <span class="mi">1</span><span class="p">,</span><span class="mi">179</span>                                 <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                           <span class="mi">1</span><span class="p">,</span><span class="mi">126</span>                                 <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                           <span class="mi">1</span><span class="p">,</span><span class="mi">217</span>                                 <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                           <span class="mi">1</span><span class="p">,</span><span class="mi">195</span>                                 <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                           <span class="mi">1</span><span class="p">,</span><span class="mi">239</span>                                 <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2018_p_to_np_child_graph.png" title="select_2018_p_to_np_child_graph" alt="select_2018_p_to_np_child_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2018_p_to_np_child_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2018</span> <span class="no">Partitioned</span> <span class="p">(</span><span class="n">child</span> <span class="n">table</span><span class="p">)</span> <span class="no">To</span> <span class="no">Master</span> <span class="no">Table</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|--------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                           <span class="mi">1</span><span class="p">,</span><span class="mi">277</span>                              <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                           <span class="mi">1</span><span class="p">,</span><span class="mi">275</span>                              <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                           <span class="mi">1</span><span class="p">,</span><span class="mi">269</span>                              <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                           <span class="mi">1</span><span class="p">,</span><span class="mi">344</span>                              <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                           <span class="mi">1</span><span class="p">,</span><span class="mi">244</span>                              <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2018_p_to_p_graph.png" title="select_2018_p_to_p_graph" alt="select_2018_p_to_p_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2018_p_to_p_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2018</span> <span class="no">Count</span> <span class="no">Partitioned</span> <span class="p">(</span><span class="n">master</span> <span class="n">table</span><span class="p">)</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|------------------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                            <span class="mi">2</span><span class="p">,</span><span class="mi">130</span>                                       <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">771</span>                                       <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">892</span>                                       <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                            <span class="mi">1</span><span class="p">,</span><span class="mo">000</span>                                       <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                            <span class="mi">1</span><span class="p">,</span><span class="mo">000</span>                                       <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2018_count_p_to_np_master_graph.png" title="select_2018_count_p_to_np_master_graph" alt="select_2018_count_p_to_np_master_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2018_count_p_to_np_master_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2018</span> <span class="no">Count</span> <span class="no">Partitioned</span> <span class="p">(</span><span class="n">child</span> <span class="n">table</span><span class="p">)</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|-----------------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                           <span class="mi">5</span><span class="p">,</span><span class="mi">957</span>                                       <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                           <span class="mi">2</span><span class="p">,</span><span class="mi">146</span>                                       <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                           <span class="mi">2</span><span class="p">,</span><span class="mi">405</span>                                       <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                           <span class="mi">2</span><span class="p">,</span><span class="mi">786</span>                                       <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                           <span class="mi">2</span><span class="p">,</span><span class="mi">708</span>                                       <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2018_count_p_to_np_child_graph.png" title="select_2018_count_p_to_np_child_graph" alt="select_2018_count_p_to_np_child_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2018_count_p_to_np_child_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2018</span> <span class="no">Count</span> <span class="no">Partitioned</span> <span class="p">(</span><span class="n">child</span> <span class="n">table</span><span class="p">)</span> <span class="no">To</span> <span class="no">Master</span> <span class="no">Table</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|--------------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                              <span class="mi">2</span><span class="p">,</span><span class="mi">796</span>                                 <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                              <span class="mi">2</span><span class="p">,</span><span class="mi">784</span>                                 <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                              <span class="mi">2</span><span class="p">,</span><span class="mi">697</span>                                 <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                              <span class="mi">2</span><span class="p">,</span><span class="mi">786</span>                                 <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                              <span class="mi">2</span><span class="p">,</span><span class="mi">708</span>                                 <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2018_count_p_to_p_graph.png" title="select_2018_count_p_to_p_graph" alt="select_2018_count_p_to_p_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2018_count_p_to_p_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2020</span> <span class="no">Partitioned</span> <span class="p">(</span><span class="n">master</span> <span class="n">tables</span><span class="p">)</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|-------------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">983</span>                                  <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">873</span>                                  <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">945</span>                                  <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">984</span>                                  <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">925</span>                                  <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2020_p_to_np_master_graph.png" title="select_2020_p_to_np_master_graph" alt="select_2020_p_to_np_master_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2020_p_to_np_master_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2020</span> <span class="no">Partitioned</span> <span class="p">(</span><span class="n">child</span> <span class="n">table</span><span class="p">)</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|-----------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                             <span class="mi">1</span><span class="p">,</span><span class="mi">274</span>                               <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                             <span class="mi">1</span><span class="p">,</span><span class="mi">151</span>                               <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                             <span class="mi">1</span><span class="p">,</span><span class="mi">200</span>                               <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                             <span class="mi">1</span><span class="p">,</span><span class="mi">241</span>                               <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                             <span class="mi">1</span><span class="p">,</span><span class="mi">170</span>                               <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2020_p_to_np_child_graph.png" title="select_2020_p_to_np_child_graph" alt="select_2020_p_to_np_child_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2020_p_to_np_child_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2020</span> <span class="no">Partitioned</span> <span class="p">(</span><span class="n">child</span> <span class="n">table</span><span class="p">)</span> <span class="no">To</span> <span class="no">Master</span> <span class="no">Table</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|--------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                            <span class="mi">1</span><span class="p">,</span><span class="mi">296</span>                             <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                            <span class="mi">1</span><span class="p">,</span><span class="mi">320</span>                             <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                            <span class="mi">1</span><span class="p">,</span><span class="mi">270</span>                             <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                            <span class="mi">1</span><span class="p">,</span><span class="mi">274</span>                             <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                            <span class="mi">1</span><span class="p">,</span><span class="mi">265</span>                             <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2020_p_to_p_graph.png" title="select_2020_p_to_p_graph" alt="select_2020_p_to_p_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2020_p_to_p_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2020</span> <span class="no">Count</span> <span class="no">Partitioned</span> <span class="p">(</span><span class="n">master</span> <span class="n">table</span><span class="p">)</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|------------------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                            <span class="mi">2</span><span class="p">,</span><span class="mi">409</span>                                       <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">792</span>                                       <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">842</span>                                       <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                            <span class="mi">1</span><span class="p">,</span><span class="mo">000</span>                                       <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">920</span>                                       <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2020_count_p_to_np_master_graph.png" title="select_2020_count_p_to_np_master_graph" alt="select_2020_count_p_to_np_master_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2020_count_p_to_np_master_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2020</span> <span class="no">Count</span> <span class="no">Partitioned</span> <span class="p">(</span><span class="n">child</span> <span class="n">table</span><span class="p">)</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|-----------------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                               <span class="mi">6</span><span class="p">,</span><span class="mi">227</span>                                   <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                               <span class="mi">2</span><span class="p">,</span><span class="mi">146</span>                                   <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                               <span class="mi">2</span><span class="p">,</span><span class="mi">316</span>                                   <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                               <span class="mi">2</span><span class="p">,</span><span class="mi">656</span>                                   <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                               <span class="mi">2</span><span class="p">,</span><span class="mi">520</span>                                   <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2020_count_p_to_np_child_graph.png" title="select_2020_count_p_to_np_child_graph" alt="select_2020_count_p_to_np_child_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2020_count_p_to_np_child_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2020</span> <span class="no">Count</span> <span class="no">Partitioned</span> <span class="p">(</span><span class="n">child</span> <span class="n">table</span><span class="p">)</span> <span class="no">To</span> <span class="no">Master</span> <span class="no">Table</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|--------------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                              <span class="mi">2</span><span class="p">,</span><span class="mi">660</span>                                 <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                              <span class="mi">2</span><span class="p">,</span><span class="mi">711</span>                                 <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                              <span class="mi">2</span><span class="p">,</span><span class="mi">750</span>                                 <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                              <span class="mi">2</span><span class="p">,</span><span class="mi">656</span>                                 <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                              <span class="mi">2</span><span class="p">,</span><span class="mi">739</span>                                 <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2020_count_p_to_p_graph.png" title="select_2020_count_p_to_p_graph" alt="select_2020_count_p_to_p_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2020_count_p_to_p_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">2019</span> <span class="no">Partitioned</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|--------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                       <span class="mi">0</span><span class="p">,</span><span class="mi">993</span>                            <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                       <span class="mi">0</span><span class="p">,</span><span class="mi">886</span>                            <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                       <span class="mi">0</span><span class="p">,</span><span class="mi">896</span>                            <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                       <span class="mi">0</span><span class="p">,</span><span class="mi">960</span>                            <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                       <span class="mi">0</span><span class="p">,</span><span class="mi">962</span>                            <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2016-2019_p_to_np_graph.png" title="select_2016-2019_p_to_np_graph" alt="select_2016-2019_p_to_np_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2016-2019_p_to_np_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">2019</span> <span class="no">Count</span> <span class="no">Partitioned</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|--------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                            <span class="mi">1</span><span class="p">,</span><span class="mi">083</span>                             <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                            <span class="mi">1</span><span class="p">,</span><span class="mo">000</span>                             <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                            <span class="mi">1</span><span class="p">,</span><span class="mi">143</span>                             <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                            <span class="mi">1</span><span class="p">,</span><span class="mo">000</span>                             <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                            <span class="mi">1</span><span class="p">,</span><span class="mo">000</span>                             <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2016-2019_count_p_to_np_graph.png" title="select_2016-select_2016-2019_count_p_to_np_graph" alt="select_2016-2019_count_p_to_np_graph-2019_p_to_np_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2016-2019_count_p_to_np_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">2020</span> <span class="no">Partitioned</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span>           <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|------------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                          <span class="mi">0</span><span class="p">,</span><span class="mi">991</span>                                   <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                          <span class="mi">0</span><span class="p">,</span><span class="mi">875</span>                                   <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                          <span class="mi">0</span><span class="p">,</span><span class="mi">948</span>                                   <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                          <span class="mi">0</span><span class="p">,</span><span class="mi">970</span>                                   <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                          <span class="mi">0</span><span class="p">,</span><span class="mi">938</span>                                   <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2018-2020_p_to_np_graph.png" title="select_2018-2020_p_to_np_graph" alt="select_2018-2020_p_to_np_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2018-2020_p_to_np_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">2020</span> <span class="no">Count</span> <span class="no">Partitioned</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|--------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                          <span class="mi">1</span><span class="p">,</span><span class="mi">214</span>                               <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                          <span class="mi">1</span><span class="p">,</span><span class="mi">182</span>                               <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                          <span class="mi">1</span><span class="p">,</span><span class="mi">375</span>                               <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                          <span class="mi">1</span><span class="p">,</span><span class="mi">429</span>                               <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                          <span class="mi">1</span><span class="p">,</span><span class="mi">143</span>                               <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_2018-2020_count_p_to_np_graph.png" title="select_2018-2020_count_p_to_np_graph" alt="2020_count_p_to_np_graph-2020_p_to_np_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_2018-2020_count_p_to_np_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="no">Last</span> <span class="mi">3</span> <span class="no">Months</span> <span class="no">Partitioned</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">999</span>                           <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">927</span>                           <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">977</span>                           <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                            <span class="mi">1</span><span class="p">,</span><span class="mo">060</span>                           <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">978</span>                           <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_last_3_months_graph.png" title="select_last_3_months_graph" alt="select_last_3_months_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_last_3_months_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="no">Last</span> <span class="mi">3</span> <span class="no">Months</span> <span class="no">Count</span> <span class="no">Partitioned</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|------------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">867</span>                                 <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">833</span>                                 <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">889</span>                                 <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">875</span>                                 <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                            <span class="mi">0</span><span class="p">,</span><span class="mi">857</span>                                 <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_last_3_months_count_graph.png" title="select_last_3_months_count_graph" alt="select_last_3_months_count_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_last_3_months_count_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="no">Last</span> <span class="mi">6</span> <span class="no">Months</span> <span class="no">Partitioned</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                         <span class="mi">1</span><span class="p">,</span><span class="mo">001</span>                              <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                         <span class="mi">0</span><span class="p">,</span><span class="mi">932</span>                              <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                         <span class="mi">0</span><span class="p">,</span><span class="mi">931</span>                              <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                         <span class="mi">1</span><span class="p">,</span><span class="mo">051</span>                              <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                         <span class="mi">0</span><span class="p">,</span><span class="mi">994</span>                              <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_last_6_months_graph.png" title="select_last_3_months_graph" alt="select_last_6_months_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_last_6_months_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="no">Last</span> <span class="mi">6</span> <span class="no">Months</span> <span class="no">Count</span> <span class="no">Partitioned</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|------------------------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                          <span class="mi">0</span><span class="p">,</span><span class="mi">867</span>                                   <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                          <span class="mi">0</span><span class="p">,</span><span class="mi">833</span>                                   <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                          <span class="mi">0</span><span class="p">,</span><span class="mi">889</span>                                   <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                          <span class="mi">0</span><span class="p">,</span><span class="mi">875</span>                                   <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                          <span class="mi">0</span><span class="p">,</span><span class="mi">857</span>                                   <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_last_6_months_count_graph.png" title="select_last_6_months_count_graph" alt="select_last_6_months_count_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_last_6_months_count_graph.png" target="_blank">See in better quality</a>
</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="o">|</span> <span class="no">Orders</span> <span class="n">amount</span> <span class="p">(</span><span class="n">mln</span><span class="p">)</span> <span class="o">|</span>  <span class="no">Select</span> <span class="no">Random</span> <span class="no">Partitioned</span> <span class="no">To</span> <span class="no">Not</span> <span class="no">Partitioned</span> <span class="no">Ratio</span> <span class="o">|</span>
</span><span class='line'><span class="o">|---------------------|-----------------------------------------------------|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">5</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                          <span class="mi">1</span><span class="p">,</span><span class="mi">098</span>                      <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">6</span><span class="p">,</span><span class="mi">25</span>         <span class="o">|</span>                          <span class="mi">0</span><span class="p">,</span><span class="mi">896</span>                      <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">7</span><span class="p">,</span><span class="mi">50</span>         <span class="o">|</span>                          <span class="mi">0</span><span class="p">,</span><span class="mi">503</span>                      <span class="o">|</span>
</span><span class='line'><span class="o">|</span>        <span class="mi">8</span><span class="p">,</span><span class="mi">75</span>         <span class="o">|</span>                          <span class="mi">0</span><span class="p">,</span><span class="mi">466</span>                      <span class="o">|</span>
</span><span class='line'><span class="o">|</span>       <span class="mi">10</span><span class="p">,</span><span class="mo">00</span>         <span class="o">|</span>                          <span class="mi">0</span><span class="p">,</span><span class="mi">424</span>                      <span class="o">|</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/partitioned_benchmark_graphs/select_random_graph.png" title="select_random_graph" alt="select_random_graph"></p>

<p class="center">
  <a href="/images/partitioned_benchmark_graphs/select_random_graph.png" target="_blank">See in better quality</a>
</p>




<p>Let&#8217;s break down these benchmarks to several groups:</p>




<p>For selecting all records and counting them the obvious conclusion is that for partitioned tables the queries are slower: slightly slower for just selecting them and noticeably slower for counting them. For selecting all orders, the ratio of partitioned to not partitioned tables query times most likely decreases as the tables&#8217; size grow and for counting it is not clear: the data doesn&#8217;t show any regular correlation, we could expect the ratio would also decrease for the larger amount of data, however, we can&#8217;t really tell based on this benchmark, which even suggests it could be a constant value. Nevertheless, table partitioning isn&#8217;t the best idea if the queries are primarily run across all the tables.</p>




<p>The results for selecting orders (queries for orders from years: 2016, 2018, 2020) only from specific date range which matches the constraints for children partitioned tabled look quite interesting: The more records we have, the better ratio (in favour of table of partitioning) we get. Table partitioning doesn&#8217;t always yield better results when the child table is not specified (see: Partitioned (master table) To Not Partitioned Ratio), but there&#8217;s a certain size of the tables when we get the ratio above 1, which means queries for partitioned tables (even without specifying a child table) are faster. When selecting from partitioned child table (see: Partitioned (child table) To Not Partitioned Ratio) the queries are faster for partitioned tables regardless of the size, which was expected. Depending on the size of the table, the difference can be quite significant, up to 28%. The data is not clear enough to be certain about the correlation with amount of orders / table size (substantial irregularity for orders from years 2020), but probably the bigger the tables are, the bigger difference of query time between partitioned and not partitioned tables, similarly to the case when the child table is not specified. The difference between explicitly running queries against a specific child table and running against a master table and relying on constraints exclusion it quite surprising: I was expecting only a slight difference, however, specifying a child table can make the queries up to 35% faster. There is a possibility this difference decreases slowly the more records there are in the tables, however, we would need more benchmarks to prove or disprove this hypothesis as there is another possibility of having costant ratio.</p>




<p>The general correlation for counting the records which can be put in the specific partitioned child tables is the same as for selecting the orders: the more records in the tables, the better performance table partitioning yields. When the child table is not specified, counting records can be faster for not partitioned tables until we reach a certain size where table partitioning seems to be a better choice performance-wise. For counting orders from all the years (2016, 2018, 2020) for 5 mln orders, the ratios are significantly different comparing to the values for higher amount of orders, which can&#8217;t be easily explained. It&#8217;s quite interesting that it happened for the queries for all the tables used in the benchmark, which might be worth investigating further, however, I would treat them as irrelevant in this case and not consider them at all. When the partitioned table is specified, the results are always better in favour of table partitioning - we can expect queries to be more than 2 times faster, even up to almost 3 times faster. Similarly to selecting the orders, the ratio of running queries against child table and master table is either a constant or slightly decreases as the amount of orders grows.</p>




<p>For selecting records form multiple children tables, the Partioned To Not Partitioned Ratio is lower than 1, which means that table partitioning would be a inferior choice for such queries, regardless of the size. However, the difference is not that significant. On the other hand, for counting the records it looks like table partitioning yields better performance, which is especially clear for 2018-2020 range, but we can&#8217;t tell what&#8217;s the correlation with the amount of orders based on the obtained results.</p>




<p>The performance for selecting records from last N months (here 3 and 6 accordingly) is quite similar for both partitioned and not partitioned strategies (ratio close to 1), which doesn&#8217;t change when the amount of orders grows. However, counting records is significantly slower, but the ratio most likely remains constant as the table gets bigger.</p>




<p>Initially, there seems to be no difference in query time between selecting orders from partitioned and not-partitioned table, but as the amount of orders grows, the performance keeps getting worse considerably, which is expected as the constraints exclusion can&#8217;t be applied in such case.</p>




<p>To sum up:</p>




<ul>
  <li>The larger amount of records, the better performance table partitioning yields</li>
  <li>Table partitioning is not optimal for all type of queries, it should be mostly used when querying only a subset of records covered by a particular child table</li>
  <li>Specifying exact child table yields much better peformance than querying master table and relying on constraint exclusion</li>
</ul>




<h2>Wrapping up</h2>




<p>Even though table partitioning requires some extra overhead and may be tricky to get started with, it is clear that the performance benefits of using it may outweight the costs when applying to the right queries. However, we need to be aware that it is not the perfect choice for all the queries and in some cases it can deteriorate the performance.</p>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Karol Galanciak</span></span>

      








  


<time datetime="2016-07-10T23:50:00+02:00" pubdate data-updated="true">Jul 10<span>th</span>, 2016</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/postgresql/'>PostgreSQL</a>, <a class='category' href='/blog/categories/ruby/'>Ruby</a>, <a class='category' href='/blog/categories/ruby-on-rails/'>Ruby on Rails</a>, <a class='category' href='/blog/categories/architecture/'>architecture</a>, <a class='category' href='/blog/categories/databases/'>databases</a>, <a class='category' href='/blog/categories/performance/'>performance</a>, <a class='category' href='/blog/categories/scaling/'>scaling</a>
  
</span>


    </p>
    <div class="meta top-line">
      <div class="post-subscription">
  <div id="mc_embed_signup">
    <div id="mc_embed_signup_scroll">
      <label for="mce-EMAIL">Do you want to take your developer skills to the next level? Subscribe to my newsletter and never miss another blog post!</label>
      <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
      <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_62804f1b69c60e0c7966cddd6_7c71fb81df" tabindex="-1" value=""></div>
      <div class="clear">
      <a href="http://eepurl.com/duztq5" target="_blank" id="mc-embedded-subscribe" class="button">Yes, I want to be a better developer!</a>
    </div>
  </div>
</div>

    </div>
    <div class="top-line">
      
        <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="https://karolgalanciak.com/blog/2016/07/10/scaling-up-rails-applications-with-postgresql-table-partitioning-part-3/" data-via="Azdaroth" data-counturl="https://karolgalanciak.com/blog/2016/07/10/scaling-up-rails-applications-with-postgresql-table-partitioning-part-3/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

      
    </div>
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2016/06/12/scaling-up-rails-applications-with-postgresql-table-partitioning-part-2/" title="Previous Post: Scaling Up Rails Applications With PostgreSQL Table Partitioning - Part 2">&laquo; Scaling Up Rails Applications With PostgreSQL Table Partitioning - Part 2</a>
      
      
        <a class="basic-alignment right" href="/blog/2016/07/31/decoding-rails-magic-how-does-calling-class-methods-on-mailers-work/" title="Next Post: Decoding Rails Magic: How Does Calling Class Methods On Mailers Work">Decoding Rails Magic: How Does Calling Class Methods On Mailers Work &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <img class="left" src="/images/me_formal.jpg" title="me:)" alt="Karol Galanciak - photo">
  <p>Hi, my name is Karol Galanciak, I'm a technical polyglot and domain expert in vacation rental industry, taking it to the next level as CTO of <a href="https://www.bookingsync.com">BookingSync</a></p>

  <p>I specialize in building APIs, enterprise integration using message queues and distributed streaming, microservices architecture and working with legacy applications.</p>

  <p id="email-me"></p>
</section>

<script type="text/javascript">
  (function(d, id, lhs, rhs) {
    d.getElementById(id).innerHTML = "You can reach me at <a rel='nofollow' href='mailto:" + lhs + "@" + rhs + "'>" + lhs + "@" + rhs + "</a>";
  })(window.document, 'email-me', 'karol.galanciak', 'gmail.com');
</script>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2019/02/24/messages-on-rails-part-1-introduction-to-kafka-and-rabbitmq/">Messages on Rails Part 1 - Introduction to Kafka and RabbitMQ</a>
      </li>
    
      <li class="post">
        <a href="/blog/2019/01/27/how-to-tell-the-difference-between-a-default-and-provided-value-for-optional-arguments-in-ruby/">How to Tell the Difference Between a Default and a Provided Value for Optional Arguments in Ruby?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/12/16/inheritance-and-define-method-how-to-make-them-work-together/">Inheritance and Define_method - How to Make Them Work Together</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/09/30/the-problems-with-validating-activerecord-models-and-why-state-validation-is-a-bad-idea/">The Problems With Validating ActiveRecord Models and Why State Validation Is a Bad Idea</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/08/19/indexes-on-rails-how-to-make-the-most-of-your-postgres-database/">Indexes on Rails: How to Make the Most of Your Postgres Database</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/Azdaroth">@Azdaroth</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'Azdaroth',
            count: 6,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>

<section>
   <h1>Twitter</h1>
   <a class="twitter-timeline" href="https://twitter.com/Azdaroth" data-widget-id="357234540634329088">Tweets by @Azdaroth</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2019 - Karol Galanciak -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'karolgalanciak';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'https://karolgalanciak.com/blog/2016/07/10/scaling-up-rails-applications-with-postgresql-table-partitioning-part-3/';
        var disqus_url = 'https://karolgalanciak.com/blog/2016/07/10/scaling-up-rails-applications-with-postgresql-table-partitioning-part-3/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
